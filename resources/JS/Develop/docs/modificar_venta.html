<!DOCTYPE html>

<html>
<head>
  <title>modificar_venta.js</title>
  <meta http-equiv="content-type" content="text/html; charset=UTF-8">
  <meta name="viewport" content="width=device-width, target-densitydpi=160dpi, initial-scale=1.0; maximum-scale=1.0; user-scalable=0;">
  <link rel="stylesheet" media="all" href="docco.css" />
</head>
<body>
  <div id="container">
    <div id="background"></div>
    
      <ul id="jump_to">
        <li>
          <a class="large" href="javascript:void(0);">Jump To &hellip;</a>
          <a class="small" href="javascript:void(0);">+</a>
          <div id="jump_wrapper">
          <div id="jump_page_wrapper">
            <div id="jump_page">
              
                
                <a class="source" href="a_dosis.html">
                  a_dosis.js
                </a>
              
                
                <a class="source" href="a_esp.html">
                  a_esp.js
                </a>
              
                
                <a class="source" href="a_unidad.html">
                  a_unidad.js
                </a>
              
                
                <a class="source" href="adm_reasignar.html">
                  adm_reasignar.js
                </a>
              
                
                <a class="source" href="adm_regs.html">
                  adm_regs.js
                </a>
              
                
                <a class="source" href="adm_regs_docsedit.html">
                  adm_regs_docsedit.js
                </a>
              
                
                <a class="source" href="adm_regs_edit.html">
                  adm_regs_edit.js
                </a>
              
                
                <a class="source" href="apm.html">
                  apm.js
                </a>
              
                
                <a class="source" href="apms.html">
                  apms.js
                </a>
              
                
                <a class="source" href="canal.html">
                  canal.js
                </a>
              
                
                <a class="source" href="canales.html">
                  canales.js
                </a>
              
                
                <a class="source" href="clientes.html">
                  clientes.js
                </a>
              
                
                <a class="source" href="control_venta.html">
                  control_venta.js
                </a>
              
                
                <a class="source" href="datos_pac.html">
                  datos_pac.js
                </a>
              
                
                <a class="source" href="defa.html">
                  defa.js
                </a>
              
                
                <a class="source" href="diff_med.html">
                  diff_med.js
                </a>
              
                
                <a class="source" href="docs_canales.html">
                  docs_canales.js
                </a>
              
                
                <a class="source" href="docs_hist_medico.html">
                  docs_hist_medico.js
                </a>
              
                
                <a class="source" href="docs_hist_paciente.html">
                  docs_hist_paciente.js
                </a>
              
                
                <a class="source" href="docs_medico.html">
                  docs_medico.js
                </a>
              
                
                <a class="source" href="docs_paciente.html">
                  docs_paciente.js
                </a>
              
                
                <a class="source" href="dosis.html">
                  dosis.js
                </a>
              
                
                <a class="source" href="especialidades.html">
                  especialidades.js
                </a>
              
                
                <a class="source" href="funciones.html">
                  funciones.js
                </a>
              
                
                <a class="source" href="generar_venta.html">
                  generar_venta.js
                </a>
              
                
                <a class="source" href="get_apm_info.html">
                  get_apm_info.js
                </a>
              
                
                <a class="source" href="informes.html">
                  informes.js
                </a>
              
                
                <a class="source" href="informes_docs_nue_pres.html">
                  informes_docs_nue_pres.js
                </a>
              
                
                <a class="source" href="informes_nue_pres.html">
                  informes_nue_pres.js
                </a>
              
                
                <a class="source" href="institucion.html">
                  institucion.js
                </a>
              
                
                <a class="source" href="instituciones.html">
                  instituciones.js
                </a>
              
                
                <a class="source" href="listado.html">
                  listado.js
                </a>
              
                
                <a class="source" href="listado_details.html">
                  listado_details.js
                </a>
              
                
                <a class="source" href="log.html">
                  log.js
                </a>
              
                
                <a class="source" href="log_accesos.html">
                  log_accesos.js
                </a>
              
                
                <a class="source" href="login.html">
                  login.js
                </a>
              
                
                <a class="source" href="medico.html">
                  medico.js
                </a>
              
                
                <a class="source" href="medicos.html">
                  medicos.js
                </a>
              
                
                <a class="source" href="modificar_venta.html">
                  modificar_venta.js
                </a>
              
                
                <a class="source" href="nueva_venta.html">
                  nueva_venta.js
                </a>
              
                
                <a class="source" href="paciente.html">
                  paciente.js
                </a>
              
                
                <a class="source" href="pacientes.html">
                  pacientes.js
                </a>
              
                
                <a class="source" href="panel.html">
                  panel.js
                </a>
              
                
                <a class="source" href="panel_mod.html">
                  panel_mod.js
                </a>
              
                
                <a class="source" href="patologia.html">
                  patologia.js
                </a>
              
                
                <a class="source" href="patologias.html">
                  patologias.js
                </a>
              
                
                <a class="source" href="reasignados.html">
                  reasignados.js
                </a>
              
                
                <a class="source" href="reasignar.html">
                  reasignar.js
                </a>
              
                
                <a class="source" href="reporte_360.html">
                  reporte_360.js
                </a>
              
                
                <a class="source" href="reporte_ANMAT.html">
                  reporte_ANMAT.js
                </a>
              
                
                <a class="source" href="reporte_docs_paciente.html">
                  reporte_docs_paciente.js
                </a>
              
                
                <a class="source" href="reporte_filtros.html">
                  reporte_filtros.js
                </a>
              
                
                <a class="source" href="reporte_grilla.html">
                  reporte_grilla.js
                </a>
              
                
                <a class="source" href="reporte_productos.html">
                  reporte_productos.js
                </a>
              
                
                <a class="source" href="reporte_reasignaciones.html">
                  reporte_reasignaciones.js
                </a>
              
                
                <a class="source" href="reporte_ventas.html">
                  reporte_ventas.js
                </a>
              
                
                <a class="source" href="reporte_ventas_apm.html">
                  reporte_ventas_apm.js
                </a>
              
                
                <a class="source" href="reporte_ventas_paciente.html">
                  reporte_ventas_paciente.js
                </a>
              
                
                <a class="source" href="reportes_panel.html">
                  reportes_panel.js
                </a>
              
                
                <a class="source" href="seguridad.html">
                  seguridad.js
                </a>
              
                
                <a class="source" href="unidades.html">
                  unidades.js
                </a>
              
                
                <a class="source" href="usuario.html">
                  usuario.js
                </a>
              
                
                <a class="source" href="usuarios.html">
                  usuarios.js
                </a>
              
            </div>
          </div>
        </li>
      </ul>
    
    <ul class="sections">
        
          <li id="title">
              <div class="annotation">
                  <h1>modificar_venta.js</h1>
              </div>
          </li>
        
        
        
        <li id="section-1">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-1">&#182;</a>
              </div>
              <p>VARIABLES GLOBALES
FIXME VERIFICAR ESTA VARIABLE</p>

            </div>
            
            <div class="content"><div class='highlight'><pre><span class="hljs-keyword">var</span> grupo_usuario = <span class="hljs-string">""</span>; <span class="hljs-comment">//VARIABLE DE GRUPO DE USUARIO</span>
<span class="hljs-keyword">var</span> aplicacion = getCurrentHostname() + <span class="hljs-string">"/"</span> + getUrlHTTP();
<span class="hljs-keyword">var</span> idPac;

<span class="hljs-keyword">var</span> fv;

$.getScript(aplicacion + <span class="hljs-string">"/resources/JS/funciones.min.js"</span>, <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) </span>{
  $(<span class="hljs-built_in">document</span>).ready(<span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) </span>{
    $(<span class="hljs-string">"#nv"</span>).window({
      <span class="hljs-attr">modal</span>: <span class="hljs-literal">true</span>,
      <span class="hljs-attr">closed</span>: <span class="hljs-literal">true</span>,
      <span class="hljs-attr">minimizable</span>: <span class="hljs-literal">false</span>,
      <span class="hljs-attr">maximizable</span>: <span class="hljs-literal">false</span>,
      <span class="hljs-attr">title</span>: <span class="hljs-string">"Nueva Operación"</span>,
      <span class="hljs-attr">closeOnEscape</span>: <span class="hljs-literal">true</span>,
      <span class="hljs-attr">draggable</span>: <span class="hljs-literal">false</span>,
      <span class="hljs-attr">maximized</span>: <span class="hljs-literal">true</span>,
      <span class="hljs-attr">inline</span>: <span class="hljs-literal">true</span>,
      <span class="hljs-attr">collapsible</span>: <span class="hljs-literal">false</span>,
      <span class="hljs-attr">constrain</span>: <span class="hljs-literal">true</span>,
      <span class="hljs-attr">onBeforeClose</span>: <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) </span>{
        <span class="hljs-built_in">window</span>.location.href = <span class="hljs-built_in">window</span>.location.href;
      },
    });
    $(<span class="hljs-string">".panel-tool-close"</span>).click(<span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) </span>{
      <span class="hljs-built_in">window</span>.location.href = <span class="hljs-built_in">window</span>.location.href;
    });</pre></div></div>
            
        </li>
        
        
        <li id="section-2">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-2">&#182;</a>
              </div>
              <p>Contadores de llamados a funciones de seteo
Se establecen para no llamar a la funcion de seteo mas de una vez</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>    <span class="hljs-keyword">var</span> countCallFMed = <span class="hljs-number">0</span>;
    <span class="hljs-keyword">var</span> countCallFCan = <span class="hljs-number">0</span>;
    <span class="hljs-keyword">var</span> countCallFInt = <span class="hljs-number">0</span>;

    l_validate_form();
    l_set_select_medico();
    l_set_select_canal();
    l_set_select_institucion();
    l_set_producto();
    l_set_paciente();

    $(<span class="hljs-string">"#canModificacion"</span>).click(<span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">e</span>) </span>{
      e.preventDefault();
      canModificacion();
    });
    $(<span class="hljs-string">"#canVenta"</span>).click(<span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">e</span>) </span>{
      e.preventDefault();
      Swal.fire({
        <span class="hljs-attr">title</span>: <span class="hljs-string">"¿Esta seguro/a de cancelar la venta?"</span>,
        <span class="hljs-attr">text</span>: <span class="hljs-string">"Este estado no se puede revertir!"</span>,
        <span class="hljs-attr">icon</span>: <span class="hljs-string">"warning"</span>,
        <span class="hljs-attr">showCancelButton</span>: <span class="hljs-literal">true</span>,
        <span class="hljs-attr">confirmButtonColor</span>: <span class="hljs-string">"#3085d6"</span>,
        <span class="hljs-attr">cancelButtonColor</span>: <span class="hljs-string">"#d33"</span>,
        <span class="hljs-attr">confirmButtonText</span>: <span class="hljs-string">"Si, cancelar!"</span>,
      }).then(<span class="hljs-function">(<span class="hljs-params">result</span>) =&gt;</span> {
        <span class="hljs-keyword">if</span> (result.value) {
          $.post(
            aplicacion + <span class="hljs-string">"/ajax/ajx.modificar_venta.php"</span>,
            {
              <span class="hljs-attr">idVenta</span>: getQuerystring(<span class="hljs-string">"idVenta"</span>),
              <span class="hljs-attr">oper</span>: <span class="hljs-string">"cancelar_venta"</span>,
            },
            <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">data, textStatus, jqXHR</span>) </span>{
              Swal.fire({
                <span class="hljs-attr">title</span>: data.title,
                <span class="hljs-attr">text</span>: data.text,
                <span class="hljs-attr">icon</span>: data.icon,
              }).then(<span class="hljs-function">(<span class="hljs-params">result</span>) =&gt;</span> {
                parent.location.reload();
              });
            },
            <span class="hljs-string">"json"</span>
          );
        }
      });
    });
  });
});

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">canModificacion</span>(<span class="hljs-params"></span>) </span>{
  $.post(aplicacion + <span class="hljs-string">"/ajax/ajx.control_modificacion_venta.php"</span>, {
    <span class="hljs-attr">idVenta</span>: getQuerystring(<span class="hljs-string">"idVenta"</span>),
    <span class="hljs-attr">oper</span>: <span class="hljs-string">"deleteControlModicacionVenta"</span>,
  }, <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">data, textStatus, jqXHR</span>) </span>{
    parent.location.reload();
    <span class="hljs-keyword">return</span>;
  });
}

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">l_modificar_venta</span>(<span class="hljs-params"></span>) </span>{
  <span class="hljs-keyword">let</span> myForm = <span class="hljs-built_in">document</span>.getElementById(<span class="hljs-string">"frmModVenta"</span>);
  <span class="hljs-keyword">var</span> form = <span class="hljs-keyword">new</span> FormData(myForm);
  form.append(<span class="hljs-string">"oper"</span>, <span class="hljs-string">"modificar_venta"</span>);
  form.append(<span class="hljs-string">"idPac"</span>, $(<span class="hljs-string">"#idPac"</span>).val());
  form.append(<span class="hljs-string">"idProducto"</span>, $(<span class="hljs-string">"#producto"</span>).val());
  form.append(<span class="hljs-string">"idVenta"</span>, getQuerystring(<span class="hljs-string">"idVenta"</span>));
  form.append(<span class="hljs-string">"idMedico"</span>, $(<span class="hljs-string">"#medico"</span>).data(<span class="hljs-string">"id"</span>));
  form.append(<span class="hljs-string">"cantUnidades"</span>, $(<span class="hljs-string">"#cantDosis"</span>).val());
  form.append(<span class="hljs-string">"idInstitucion"</span>, $(<span class="hljs-string">"#institucion"</span>).data(<span class="hljs-string">"id"</span>));
  form.append(<span class="hljs-string">"idCanal"</span>, $(<span class="hljs-string">"#canal"</span>).data(<span class="hljs-string">"id"</span>));
  form.append(<span class="hljs-string">"idPresentacion"</span>, $(<span class="hljs-string">"#presentacion"</span>).val());

  <span class="hljs-keyword">var</span> settings = {
    <span class="hljs-attr">url</span>: aplicacion + <span class="hljs-string">"/ajax/ajx.modificar_venta.php"</span>,
    <span class="hljs-attr">method</span>: <span class="hljs-string">"POST"</span>,
    <span class="hljs-attr">processData</span>: <span class="hljs-literal">false</span>,
    <span class="hljs-attr">mimeType</span>: <span class="hljs-string">"multipart/form-data"</span>,
    <span class="hljs-attr">contentType</span>: <span class="hljs-literal">false</span>,
    <span class="hljs-attr">data</span>: form,
  };

  $.ajax(settings).done(<span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">response</span>) </span>{
    <span class="hljs-keyword">let</span> data = <span class="hljs-built_in">JSON</span>.parse(response);
    <span class="hljs-built_in">console</span>.log(data);
    Swal.fire({
      <span class="hljs-attr">title</span>: data.title,
      <span class="hljs-attr">icon</span>: data.icon,
      <span class="hljs-attr">text</span>: data.text,
      <span class="hljs-attr">timer</span>: <span class="hljs-number">5000</span>,
    }).then(<span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) </span>{
      parent.location.reload();
    });
  });
}

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">l_set_paciente</span>(<span class="hljs-params"></span>) </span>{
  $.post(
    aplicacion + <span class="hljs-string">"/ajax/ajx.paciente.php"</span>,
    { <span class="hljs-attr">oper</span>: <span class="hljs-string">"showPaciente"</span>, <span class="hljs-attr">id</span>: getQuerystring(<span class="hljs-string">"idPac"</span>) },
    <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">data</span>) </span>{
      $.map(data, <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">e</span>) </span>{
        $(<span class="hljs-string">"#nombrePaciente"</span>).html(e.nombre_completo);
      });
    },
    <span class="hljs-string">"json"</span>
  );
}

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">l_set_producto</span>(<span class="hljs-params"></span>) </span>{
  $.getJSON(
    aplicacion + <span class="hljs-string">"/ajax/ajx.producto.php"</span>,
    { <span class="hljs-attr">oper</span>: <span class="hljs-string">"getproducto"</span> },
    <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">data, textStatus, jqXHR</span>) </span>{
      $.each(data, <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">i, v</span>) </span>{
        $(<span class="hljs-string">"#producto"</span>).val(v.id);
        $(<span class="hljs-string">"#productoTitle"</span>).html(v.valor);
        l_set_select_presentacion(v.id);
      });
    }
  );
}

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">l_validate_form</span>(<span class="hljs-params"></span>) </span>{
  <span class="hljs-keyword">const</span> noExiste = <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) </span>{
    <span class="hljs-keyword">return</span> {
      <span class="hljs-attr">validate</span>: <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">input</span>) </span>{
        <span class="hljs-keyword">return</span> {
          <span class="hljs-attr">valid</span>: <span class="hljs-literal">false</span>,
          <span class="hljs-attr">message</span>: <span class="hljs-string">"* No se encontraron coincidencias"</span>,
        };
      },
    };
  };

  <span class="hljs-keyword">const</span> dateValidators = {
    <span class="hljs-attr">validators</span>: {
      <span class="hljs-attr">date</span>: {
        <span class="hljs-attr">format</span>: <span class="hljs-string">"DD-MM-YYYY"</span>,
        <span class="hljs-attr">message</span>: <span class="hljs-string">"El formato es invalido"</span>,
      },
      <span class="hljs-attr">notEmpty</span>: {
        <span class="hljs-attr">message</span>: <span class="hljs-string">"Debe indicar una fecha para este Documento"</span>,
      },
    },
  };

  <span class="hljs-keyword">const</span> fileValidators = {
    <span class="hljs-attr">validators</span>: {
      <span class="hljs-attr">notEmpty</span>: {
        <span class="hljs-attr">message</span>: <span class="hljs-string">"Debe Seleccionar un Archivo"</span>,
      },
      <span class="hljs-attr">file</span>: {
        <span class="hljs-attr">extension</span>: <span class="hljs-string">"jpg,png,gif,doc,pdf,zip,bmp,tif"</span>,
        <span class="hljs-attr">type</span>:
          <span class="hljs-string">"image/jpeg,image/png,image/gif,application/msword,application/pdf,application/zip,image/x-ms-bmp,image/tiff"</span>,
        <span class="hljs-attr">maxSize</span>: <span class="hljs-number">2097152</span>, <span class="hljs-comment">// 2048 * 1024</span>
        <span class="hljs-attr">message</span>: <span class="hljs-string">"El archivo seleccionado no es válido"</span>,
      },
    },
  };</pre></div></div>
            
        </li>
        
        
        <li id="section-3">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-3">&#182;</a>
              </div>
              <p>Registrando custom validator</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>  FormValidation.validators.noExiste = noExiste;</pre></div></div>
            
        </li>
        
        
        <li id="section-4">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-4">&#182;</a>
              </div>
              <p>Instancia del form</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>  fv = FormValidation.formValidation(<span class="hljs-built_in">document</span>.getElementById(<span class="hljs-string">"frmModVenta"</span>), {
    <span class="hljs-attr">fields</span>: {
      <span class="hljs-attr">medico</span>: {
        <span class="hljs-attr">validators</span>: {
          <span class="hljs-attr">noExiste</span>: {
            <span class="hljs-attr">enable</span>: <span class="hljs-literal">false</span>,
          },
          <span class="hljs-attr">stringLength</span>: {
            <span class="hljs-attr">min</span>: <span class="hljs-number">3</span>,
            <span class="hljs-attr">message</span>: <span class="hljs-string">"Ingrese más de 3 letras"</span>,
          },
          <span class="hljs-attr">notEmpty</span>: {
            <span class="hljs-attr">message</span>: <span class="hljs-string">"Este campo no puede quedar vacío"</span>,
          },
          <span class="hljs-attr">checkMedico</span>: {
            <span class="hljs-attr">message</span>: <span class="hljs-string">"Seleccione un médico del Listado"</span>,
            <span class="hljs-attr">callback</span>: <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">input</span>) </span>{
              <span class="hljs-keyword">const</span> medicoSelected = <span class="hljs-built_in">document</span>
                .getElementById(<span class="hljs-string">"frmModVenta"</span>)
                .querySelector(<span class="hljs-string">'[name="medicoSelected"]'</span>).value;
              <span class="hljs-keyword">if</span> (input == <span class="hljs-string">""</span> &amp;&amp; medicoSelected == <span class="hljs-string">""</span>) {
                <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;
              } <span class="hljs-keyword">else</span> {
                <span class="hljs-keyword">return</span> input.value == medicoSelected;
              }
            },
          },
        },
      },
      <span class="hljs-attr">presentacion</span>: {
        <span class="hljs-attr">validators</span>: {
          <span class="hljs-attr">notEmpty</span>: {
            <span class="hljs-attr">message</span>: <span class="hljs-string">"Debe seleccionar una dosís"</span>,
          },
        },
      },
      <span class="hljs-attr">cantDosis</span>: {
        <span class="hljs-attr">message</span>: <span class="hljs-string">"El nombre de la ciudad no es válida"</span>,
        <span class="hljs-attr">validators</span>: {
          <span class="hljs-attr">regexp</span>: {
            <span class="hljs-attr">regexp</span>: <span class="hljs-regexp">/^[0-9]*$/</span>,
            message: <span class="hljs-string">"Este campo debe contener solo números."</span>,
          },
          <span class="hljs-attr">greaterThan</span>: {
            <span class="hljs-attr">min</span>: <span class="hljs-number">1</span>,
            <span class="hljs-attr">message</span>: <span class="hljs-string">"El valor indicado debe ser mayor a 0"</span>,
          },
          <span class="hljs-attr">notEmpty</span>: {
            <span class="hljs-attr">message</span>: <span class="hljs-string">"Debe indicar la cantidad de Dosis"</span>,
          },
        },
      },
      <span class="hljs-attr">canal</span>: {
        <span class="hljs-attr">validators</span>: {
          <span class="hljs-attr">noExiste</span>: {
            <span class="hljs-attr">enable</span>: <span class="hljs-literal">false</span>,
          },
          <span class="hljs-attr">stringLength</span>: {
            <span class="hljs-attr">min</span>: <span class="hljs-number">3</span>,
            <span class="hljs-attr">message</span>: <span class="hljs-string">"Ingrese más de 3 letras"</span>,
          },
          <span class="hljs-attr">notEmpty</span>: {
            <span class="hljs-attr">message</span>: <span class="hljs-string">"Debe Seleccionar un Canal"</span>,
          },
          <span class="hljs-attr">checkCanal</span>: {
            <span class="hljs-attr">message</span>: <span class="hljs-string">"Seleccione un canal del Listado"</span>,
            <span class="hljs-attr">callback</span>: <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">input</span>) </span>{
              <span class="hljs-keyword">const</span> canalSelected = <span class="hljs-built_in">document</span>
                .getElementById(<span class="hljs-string">"frmModVenta"</span>)
                .querySelector(<span class="hljs-string">'[name="canalSelected"]'</span>).value;
              <span class="hljs-keyword">if</span> (input == <span class="hljs-string">""</span> &amp;&amp; canalSelected == <span class="hljs-string">""</span>) {
                <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;
              } <span class="hljs-keyword">else</span> {
                <span class="hljs-keyword">return</span> input.value == canalSelected;
              }
            },
          },
        },
      },
      <span class="hljs-attr">institucion</span>: {
        <span class="hljs-attr">validators</span>: {
          <span class="hljs-attr">noExiste</span>: {
            <span class="hljs-attr">enable</span>: <span class="hljs-literal">false</span>,
          },
          <span class="hljs-attr">stringLength</span>: {
            <span class="hljs-attr">min</span>: <span class="hljs-number">3</span>,
            <span class="hljs-attr">message</span>: <span class="hljs-string">"Ingrese más de 3 letras"</span>,
          },
          <span class="hljs-attr">checkInstitucion</span>: {
            <span class="hljs-attr">message</span>: <span class="hljs-string">"Seleccione una Institución del Listado"</span>,
            <span class="hljs-attr">callback</span>: <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">input</span>) </span>{
              <span class="hljs-keyword">const</span> institucionSelected = <span class="hljs-built_in">document</span>
                .getElementById(<span class="hljs-string">"frmModVenta"</span>)
                .querySelector(<span class="hljs-string">'[name="institucionSelected"]'</span>).value;
              <span class="hljs-keyword">if</span> (input == <span class="hljs-string">""</span> &amp;&amp; institucionSelected == <span class="hljs-string">""</span>) {
                <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;
              } <span class="hljs-keyword">else</span> {
                <span class="hljs-keyword">return</span> input.value == institucionSelected;
              }
            },
          },
        },
      },
      <span class="hljs-comment">/*f_receta: dateValidators,
      file_receta: fileValidators*/</span>
    },
    <span class="hljs-attr">plugins</span>: {
      <span class="hljs-attr">alias</span>: <span class="hljs-keyword">new</span> FormValidation.plugins.Alias({</pre></div></div>
            
        </li>
        
        
        <li id="section-5">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-5">&#182;</a>
              </div>
              <p>These checkers are treated as callback validator</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>        checkMedico: <span class="hljs-string">"callback"</span>,
        <span class="hljs-attr">checkInstitucion</span>: <span class="hljs-string">"callback"</span>,
        <span class="hljs-attr">checkCanal</span>: <span class="hljs-string">"callback"</span>,
      }),
      <span class="hljs-attr">trigger</span>: <span class="hljs-keyword">new</span> FormValidation.plugins.Trigger(),
      <span class="hljs-attr">bulma</span>: <span class="hljs-keyword">new</span> FormValidation.plugins.Bulma(),
      <span class="hljs-attr">submitButton</span>: <span class="hljs-keyword">new</span> FormValidation.plugins.SubmitButton(),
      <span class="hljs-attr">icon</span>: <span class="hljs-keyword">new</span> FormValidation.plugins.Icon({
        <span class="hljs-attr">valid</span>: <span class="hljs-string">"fa fa-check"</span>,
        <span class="hljs-attr">invalid</span>: <span class="hljs-string">"invalid-fv fa fa-times"</span>,
        <span class="hljs-attr">validating</span>: <span class="hljs-string">"fa fa-refresh"</span>,
      }),
    },
  })
    .on(<span class="hljs-string">"core.field.invalid"</span>, <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">e</span>) </span>{
      <span class="hljs-keyword">if</span> (e == <span class="hljs-string">"file_receta"</span>) {
        $(<span class="hljs-string">'i[data-field="file_receta"'</span>).removeClass(<span class="hljs-string">"fa-times"</span>);
        $(<span class="hljs-string">"#divFileReceta"</span>).removeClass(<span class="hljs-string">"is-info"</span>).addClass(<span class="hljs-string">"is-danger"</span>);
      }
      <span class="hljs-keyword">if</span> (e == <span class="hljs-string">"file_otro"</span>) {
        $(<span class="hljs-string">'i[data-field="file_otro"'</span>).removeClass(<span class="hljs-string">"fa-times"</span>);
        $(<span class="hljs-string">"#divFileOtro"</span>).removeClass(<span class="hljs-string">"is-info"</span>).addClass(<span class="hljs-string">"is-danger"</span>);
      }
    })
    .on(<span class="hljs-string">"core.field.valid"</span>, <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">e</span>) </span>{
      <span class="hljs-keyword">if</span> (e == <span class="hljs-string">"file_receta"</span>) {
        $(<span class="hljs-string">'i[data-field="file_receta"'</span>).removeClass(<span class="hljs-string">"fa-check"</span>);
        $(<span class="hljs-string">"#iconReceta"</span>).removeClass(<span class="hljs-string">"fa-upload"</span>).addClass(<span class="hljs-string">"fa-check"</span>);
        $(<span class="hljs-string">"#divFileReceta"</span>).removeClass(<span class="hljs-string">"is-danger"</span>).addClass(<span class="hljs-string">"is-success"</span>);
      }
      <span class="hljs-keyword">if</span> (e == <span class="hljs-string">"file_otro"</span>) {
        $(<span class="hljs-string">'i[data-field="file_otro"'</span>).removeClass(<span class="hljs-string">"fa-check"</span>);
        $(<span class="hljs-string">"#iconFileOtro"</span>).removeClass(<span class="hljs-string">"fa-upload"</span>).addClass(<span class="hljs-string">"fa-check"</span>);
        $(<span class="hljs-string">"#divFileOtro"</span>).removeClass(<span class="hljs-string">"is-danger"</span>).addClass(<span class="hljs-string">"is-success"</span>);
      }
    })
    .on(<span class="hljs-string">"core.form.valid"</span>, <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) </span>{
      <span class="hljs-comment">/*$("#divFileReceta").removeClass("is-danger").addClass("is-succes");
      if ($("file_otro" !== "")) {
        $("#divFileReceta").removeClass("is-danger").addClass("is-succes");
      }*/</span>
      fv.destroy();
      l_modificar_venta();
    })
    .on(<span class="hljs-string">"core.field.added"</span>, <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">e</span>) </span>{});

  $(<span class="hljs-string">"#btnAddDoc"</span>).click(<span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">e</span>) </span>{
    <span class="hljs-keyword">const</span> fieldsOtro = <span class="hljs-string">`&lt;div class="field-label"&gt;&lt;label class="label is-normal"&gt;Otro&lt;/label&gt;&lt;/div&gt;
    &lt;div class="field-body"&gt;
        &lt;div class="field"&gt;
            &lt;div class="control has-icons-right"&gt;
                &lt;input id="f_otro" name="f_otro" type="text" placeholder="Fecha de Documento" class="input date"&gt;
                &lt;span class="icon is-small is-right"&gt;
                    &lt;i data-field="f_otro" class=""&gt;&lt;/i&gt;
                &lt;/span&gt;
            &lt;/div&gt;
            &lt;div class="fv-plugins-message-container"&gt;&lt;/div&gt;
        &lt;/div&gt;
        &lt;div class="field fv-plugins-icon-container"&gt;
            &lt;div class="control file is-info has-icons-right" id="divFileOtro"&gt;
                &lt;label class="file-label"&gt;
                    &lt;input class="file-input" type="file" name="file_otro" id="file_otro"&gt;
                    &lt;span class="file-cta"&gt;
                        &lt;span class="file-icon"&gt;
                            &lt;i id="iconFileOtro" class="fa fa-upload"&gt;&lt;/i&gt;
                        &lt;/span&gt;
                        &lt;span class="file-label"&gt;
                            Otro
                        &lt;/span&gt;
                    &lt;/span&gt;
                &lt;/label&gt;
                &lt;span class="icon is-small is-right"&gt;
                    &lt;i data-field="f_otro" class=""&gt;&lt;/i&gt;
                &lt;/span&gt;
            &lt;/div&gt;
            &lt;div class="fv-plugins-message-container"&gt;&lt;/div&gt;
        &lt;/div&gt;
        &lt;div class="field"&gt;
            &lt;p class="control"&gt;
            &lt;button class="button is-danger" id="btnRemDocOtro" type="button"&gt;
                &lt;span class="icon is-small" title="Borrar Documento"&gt;
                    &lt;i class="fa fa-times"&gt;&lt;/i&gt;
                &lt;/span&gt;
            &lt;/button&gt;
            &lt;/p&gt;
        &lt;/div&gt;
    &lt;/div&gt;`</span>;

    $(<span class="hljs-string">"#divOtroDocumento"</span>).html(fieldsOtro).show();
    $(<span class="hljs-string">"#divAddDoc"</span>).hide();
    l_set_datepicker();
    fv.addField(<span class="hljs-string">"f_otro"</span>, dateValidators).addField(<span class="hljs-string">"file_otro"</span>, fileValidators);
  });
  $(<span class="hljs-string">"#f_otro"</span>).change(<span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) </span>{
    fv.revalidateField(<span class="hljs-string">"f_otro"</span>);
  });
  $(<span class="hljs-string">"#file_otro"</span>).change(<span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) </span>{
    fv.revalidateField(<span class="hljs-string">"file_otro"</span>);
  });</pre></div></div>
            
        </li>
        
        
        <li id="section-6">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-6">&#182;</a>
              </div>
              <p>Cuando se selecciona el cambio de la Documentación de Receta
se setea nuevamente el campo de fecha y la selección del documento</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>  $(<span class="hljs-string">"#btnRemDocReceta"</span>).click(<span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">e</span>) </span>{
    <span class="hljs-keyword">const</span> fieldsReceta = <span class="hljs-string">`
        &lt;div class="field-label"&gt;&lt;label class="label is-normal"&gt;Receta&lt;/label&gt;&lt;/div&gt;
            &lt;div class="field-body"&gt;
                &lt;div class="field"&gt;
                    &lt;div class="control has-icons-right"&gt;
                        &lt;input id="f_receta" name="f_receta" type="text" placeholder="Fecha de Documento" class="form-control input date"&gt;
                        &lt;span class="icon is-small is-right"&gt;
                            &lt;i data-field="f_receta" class=""&gt;&lt;/i&gt;
                        &lt;/span&gt;
                    &lt;/div&gt;
                    &lt;div class="fv-plugins-message-container"&gt;&lt;/div&gt;
                &lt;/div&gt;
                &lt;div class="field"&gt;
                    &lt;div class="control file is-info has-icons-right" id="divFileReceta"&gt;
                        &lt;label class="file-label"&gt;
                            &lt;input class="file-input" type="file" name="file_receta" id="file_receta"&gt;
                            &lt;span class="file-cta"&gt;
                                &lt;span class="file-icon"&gt;
                                    &lt;i id="iconReceta" class="fa fa-upload"&gt;&lt;/i&gt;
                                &lt;/span&gt;
                                &lt;span class="file-label"&gt;
                                    Receta
                                &lt;/span&gt;
                            &lt;/span&gt;
                        &lt;/label&gt;
                        &lt;span class="icon is-small is-right"&gt;
                            &lt;i data-field="lastName" class=""&gt;&lt;/i&gt;
                        &lt;/span&gt;
                    &lt;/div&gt;
                    &lt;div class="fv-plugins-message-container"&gt;&lt;/div&gt;
                &lt;/div&gt;
            &lt;/div&gt;
      `</span>;
    $(<span class="hljs-string">"#divRecetaDocumento"</span>).html(fieldsReceta);
    l_set_datepicker();
    fv.addField(<span class="hljs-string">"f_receta"</span>, dateValidators).addField(
      <span class="hljs-string">"file_receta"</span>,
      fileValidators
    );
  });
  $(<span class="hljs-string">"#f_receta"</span>).change(<span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) </span>{
    fv.revalidateField(<span class="hljs-string">"f_otro"</span>);
  });
  $(<span class="hljs-string">"#file_receta"</span>).change(<span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) </span>{
    fv.revalidateField(<span class="hljs-string">"file_otro"</span>);
  });

  $(<span class="hljs-string">"#btnRemDocOtro"</span>).click(<span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">e</span>) </span>{
    $(<span class="hljs-string">"#divOtroDocumento"</span>).hide();
    $(<span class="hljs-string">"#divAddDoc"</span>).show();
    <span class="hljs-keyword">if</span> ($(<span class="hljs-string">"f_otro"</span>).is(<span class="hljs-string">":disabled"</span>)) {
      fv.removeField(<span class="hljs-string">"f_otro"</span>, dateValidators).removeField(
        <span class="hljs-string">"file_otro"</span>,
        fileValidators
      );
    }
  });

  $(<span class="hljs-string">"body"</span>).on(<span class="hljs-string">"click"</span>, <span class="hljs-string">"#btnRemDocOtro"</span>, <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) </span>{
    $(<span class="hljs-string">"#divOtroDocumento"</span>).hide();
    $(<span class="hljs-string">"#divAddDoc"</span>).show();
    <span class="hljs-keyword">if</span> ($(<span class="hljs-string">"f_otro"</span>).is(<span class="hljs-string">":disabled"</span>)) {
      fv.removeField(<span class="hljs-string">"f_otro"</span>, dateValidators).removeField(
        <span class="hljs-string">"file_otro"</span>,
        fileValidators
      );
    }
  });
}

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">l_set_datepicker</span>(<span class="hljs-params"></span>) </span>{
  $(<span class="hljs-string">".date"</span>).datepicker({
    <span class="hljs-attr">format</span>: <span class="hljs-string">"dd-mm-yyyy"</span>,
    <span class="hljs-attr">language</span>: <span class="hljs-string">"es"</span>,
    <span class="hljs-attr">endDate</span>: getDate(),
    <span class="hljs-attr">calendarWeeks</span>: <span class="hljs-literal">true</span>,
    <span class="hljs-attr">autoclose</span>: <span class="hljs-literal">true</span>,
    <span class="hljs-attr">clearBtn</span>: <span class="hljs-literal">true</span>,
    <span class="hljs-attr">todayHighlight</span>: <span class="hljs-literal">true</span>,
  });
}

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">l_set_select_medico</span>(<span class="hljs-params"></span>) </span>{
  $(<span class="hljs-string">"#helpMedico"</span>).addClass(<span class="hljs-string">"is-success"</span>);
  $(<span class="hljs-string">"#helpMedico"</span>).html(<span class="hljs-string">"* Comience a escribir para seleccionar un médico"</span>);
  fv.disableValidator(<span class="hljs-string">"medico"</span>, <span class="hljs-string">"noExiste"</span>).revalidateField(<span class="hljs-string">"medico"</span>);
  $(<span class="hljs-string">"#medico"</span>).keyup(<span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) </span>{
    <span class="hljs-keyword">var</span> minlength = <span class="hljs-number">3</span>;
    <span class="hljs-keyword">var</span> searchField = $(<span class="hljs-string">"#medico"</span>).val();
    <span class="hljs-keyword">var</span> regex = <span class="hljs-keyword">new</span> <span class="hljs-built_in">RegExp</span>(searchField, <span class="hljs-string">"i"</span>);
    <span class="hljs-keyword">var</span> output = <span class="hljs-string">'&lt;div class="list is-hoverable"&gt;'</span>;
    <span class="hljs-keyword">var</span> count = <span class="hljs-number">1</span>;
    <span class="hljs-keyword">var</span> url_json = aplicacion + <span class="hljs-string">"/ajax/ajx.medicos.php?q="</span> + searchField;
    <span class="hljs-keyword">if</span> (searchField != <span class="hljs-literal">null</span> &amp;&amp; searchField.length &gt;= minlength) {
      $.getJSON(url_json, <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">data</span>) </span>{
        <span class="hljs-keyword">if</span> (data.length != <span class="hljs-number">0</span>) {
          fv.disableValidator(<span class="hljs-string">"medico"</span>, <span class="hljs-string">"noExiste"</span>).revalidateField(<span class="hljs-string">"medico"</span>);
          $.each(data, <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">key, val</span>) </span>{
            <span class="hljs-keyword">if</span> (val.text.search(regex) != <span class="hljs-number">-1</span>) {
              output += <span class="hljs-string">`&lt;a class="list-item" id="span_medico" name="span_medico" data-id="<span class="hljs-subst">${val.id}</span>"&gt;<span class="hljs-subst">${val.text}</span>`</span>;
              <span class="hljs-keyword">if</span> (count % <span class="hljs-number">2</span> == <span class="hljs-number">0</span>) {
                output += <span class="hljs-string">"&lt;/a&gt;"</span>;
              }
              count++;
            }
          });
          output += <span class="hljs-string">"&lt;/div&gt;"</span>;
          $(<span class="hljs-string">"#result_medicos"</span>).html(output);
        } <span class="hljs-keyword">else</span> {
          $(<span class="hljs-string">"#helpMedico"</span>).removeClass(<span class="hljs-string">"is-success"</span>);
          $(<span class="hljs-string">"#helpMedico"</span>).addClass(<span class="hljs-string">"is-danger"</span>);
          fv.enableValidator(<span class="hljs-string">"medico"</span>, <span class="hljs-string">"noExiste"</span>).revalidateField(<span class="hljs-string">"medico"</span>);
          $(<span class="hljs-string">"#helpMedico"</span>).html(<span class="hljs-string">""</span>);
          $(<span class="hljs-string">"#result_medicos"</span>).html(<span class="hljs-string">""</span>);
        }
      });
    } <span class="hljs-keyword">else</span> {
      <span class="hljs-keyword">if</span> (searchField.length &lt; minlength) {
        $(<span class="hljs-string">"#result_medicos"</span>).html(<span class="hljs-string">""</span>);
      }
    }
  });

  $(<span class="hljs-built_in">document</span>).on(<span class="hljs-string">"click"</span>, <span class="hljs-string">"#span_medico"</span>, <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) </span>{
    <span class="hljs-keyword">var</span> idMedico = $(<span class="hljs-keyword">this</span>).attr(<span class="hljs-string">"data-id"</span>).toLowerCase();
    <span class="hljs-keyword">var</span> n_medico = $(<span class="hljs-keyword">this</span>).text();
    $(<span class="hljs-string">"#medico"</span>).data(<span class="hljs-string">"id"</span>, idMedico);
    $(<span class="hljs-string">"#medico"</span>).val(n_medico);
    $(<span class="hljs-string">"#medicoSelected"</span>).val(n_medico);
    <span class="hljs-keyword">if</span> ($(<span class="hljs-string">"#medico"</span>).val() == n_medico) {
      fv.disableValidator(<span class="hljs-string">"medico"</span>, <span class="hljs-string">"noExiste"</span>).revalidateField(<span class="hljs-string">"medico"</span>);
      $(<span class="hljs-string">"#helpMedico"</span>).html(<span class="hljs-string">""</span>);
    } <span class="hljs-keyword">else</span> {
      fv.enableValidator(<span class="hljs-string">"medico"</span>, <span class="hljs-string">"noExiste"</span>).revalidateField(<span class="hljs-string">"medico"</span>);
    }
    $(<span class="hljs-string">"#result_medicos"</span>).html(<span class="hljs-string">""</span>);
  });
}

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">l_set_select_canal</span>(<span class="hljs-params"></span>) </span>{
  $(<span class="hljs-string">"#helpCanal"</span>).addClass(<span class="hljs-string">"is-success"</span>);
  $(<span class="hljs-string">"#helpCanal"</span>).html(<span class="hljs-string">"* Comience a escribir para seleccionar un Canal"</span>);
  fv.disableValidator(<span class="hljs-string">"canal"</span>, <span class="hljs-string">"noExiste"</span>).revalidateField(<span class="hljs-string">"canal"</span>);
  $(<span class="hljs-string">"#canal"</span>).keyup(<span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) </span>{
    <span class="hljs-keyword">var</span> minlength = <span class="hljs-number">3</span>;
    <span class="hljs-keyword">var</span> searchField = $(<span class="hljs-string">"#canal"</span>).val();
    <span class="hljs-keyword">var</span> regex = <span class="hljs-keyword">new</span> <span class="hljs-built_in">RegExp</span>(searchField, <span class="hljs-string">"i"</span>);
    <span class="hljs-keyword">var</span> output = <span class="hljs-string">'&lt;div class="list is-hoverable"&gt;'</span>;
    <span class="hljs-keyword">var</span> count = <span class="hljs-number">1</span>;
    <span class="hljs-keyword">var</span> url_json = aplicacion + <span class="hljs-string">"/ajax/ajx.canales.php?q="</span> + searchField;
    <span class="hljs-keyword">if</span> (searchField != <span class="hljs-literal">null</span> &amp;&amp; searchField.length &gt;= minlength) {
      $.getJSON(url_json, <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">data</span>) </span>{
        <span class="hljs-keyword">if</span> (data.length != <span class="hljs-number">0</span>) {
          fv.disableValidator(<span class="hljs-string">"canal"</span>, <span class="hljs-string">"noExiste"</span>).revalidateField(<span class="hljs-string">"canal"</span>);
          $.each(data, <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">key, val</span>) </span>{
            <span class="hljs-keyword">if</span> (val.text.search(regex) != <span class="hljs-number">-1</span>) {
              output += <span class="hljs-string">`&lt;a class="list-item" id="span_canal" data-id="<span class="hljs-subst">${val.id}</span>"&gt;<span class="hljs-subst">${val.text}</span>`</span>;
              <span class="hljs-keyword">if</span> (count % <span class="hljs-number">2</span> == <span class="hljs-number">0</span>) {
                output += <span class="hljs-string">"&lt;/a&gt;"</span>;
              }
              count++;
            }
          });
          output += <span class="hljs-string">"&lt;/div&gt;"</span>;
          $(<span class="hljs-string">"#result_canal"</span>).html(output);
        } <span class="hljs-keyword">else</span> {
          fv.enableValidator(<span class="hljs-string">"canal"</span>, <span class="hljs-string">"noExiste"</span>).revalidateField(<span class="hljs-string">"canal"</span>);
          $(<span class="hljs-string">"#result_canal"</span>).html(<span class="hljs-string">""</span>);
          $(<span class="hljs-string">"#helpCanal"</span>).html(<span class="hljs-string">""</span>);
          $(<span class="hljs-string">"#helpCanal"</span>).removeClass(<span class="hljs-string">"is-success"</span>);
          $(<span class="hljs-string">"#helpCanal"</span>).addClass(<span class="hljs-string">"is-danger"</span>);
          $(<span class="hljs-string">"#helpCanal"</span>).html(<span class="hljs-string">""</span>);
        }
      });
    } <span class="hljs-keyword">else</span> {
      <span class="hljs-keyword">if</span> (searchField.length + <span class="hljs-number">1</span> &lt; minlength) {
        $(<span class="hljs-string">"#result_canal"</span>).html(<span class="hljs-string">""</span>);
      }
    }
  });

  $(<span class="hljs-built_in">document</span>).on(<span class="hljs-string">"click"</span>, <span class="hljs-string">"#span_canal"</span>, <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) </span>{
    <span class="hljs-keyword">var</span> idCanal = $(<span class="hljs-keyword">this</span>).attr(<span class="hljs-string">"data-id"</span>).toLowerCase();
    <span class="hljs-keyword">var</span> n_canal = $(<span class="hljs-keyword">this</span>).text();
    $(<span class="hljs-string">"#canal"</span>).data(<span class="hljs-string">"id"</span>, idCanal);
    $(<span class="hljs-string">"#canal"</span>).val(n_canal);
    $(<span class="hljs-string">"#canalSelected"</span>).val(n_canal);
    <span class="hljs-keyword">if</span> ($(<span class="hljs-string">"#canal"</span>).val() == n_canal) {
      fv.disableValidator(<span class="hljs-string">"canal"</span>, <span class="hljs-string">"noExiste"</span>).revalidateField(<span class="hljs-string">"canal"</span>);
      $(<span class="hljs-string">"#helpCanal"</span>).html(<span class="hljs-string">""</span>);
    } <span class="hljs-keyword">else</span> {
      fv.enableValidator(<span class="hljs-string">"canal"</span>, <span class="hljs-string">"noExiste"</span>).revalidateField(<span class="hljs-string">"canal"</span>);
    }
    $(<span class="hljs-string">"#result_canal"</span>).html(<span class="hljs-string">""</span>);
  });
}

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">l_set_select_institucion</span>(<span class="hljs-params"></span>) </span>{
  $(<span class="hljs-string">"#helpInstitucion"</span>).addClass(<span class="hljs-string">"is-success"</span>);
  $(<span class="hljs-string">"#helpInstitucion"</span>).html(
    <span class="hljs-string">"* Comience a escribir para seleccionar una Institución"</span>
  );
  fv.disableValidator(<span class="hljs-string">"institucion"</span>, <span class="hljs-string">"noExiste"</span>).revalidateField(<span class="hljs-string">"institucion"</span>);
  $(<span class="hljs-string">"#institucion"</span>).keyup(<span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) </span>{
    <span class="hljs-keyword">var</span> minlength = <span class="hljs-number">3</span>;
    <span class="hljs-keyword">var</span> searchField = $(<span class="hljs-string">"#institucion"</span>).val();
    <span class="hljs-keyword">var</span> regex = <span class="hljs-keyword">new</span> <span class="hljs-built_in">RegExp</span>(searchField, <span class="hljs-string">"i"</span>);
    <span class="hljs-keyword">var</span> output = <span class="hljs-string">'&lt;div class="list is-hoverable"&gt;'</span>;
    <span class="hljs-keyword">var</span> count = <span class="hljs-number">1</span>;
    <span class="hljs-keyword">var</span> url_json = aplicacion + <span class="hljs-string">"/ajax/ajx.instituciones.php?q="</span> + searchField;
    <span class="hljs-keyword">if</span> (searchField != <span class="hljs-literal">null</span> &amp;&amp; searchField.length &gt;= minlength) {
      $.getJSON(url_json, <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">data</span>) </span>{
        <span class="hljs-keyword">if</span> (data.length != <span class="hljs-number">0</span>) {
          fv.disableValidator(<span class="hljs-string">"institucion"</span>, <span class="hljs-string">"noExiste"</span>).revalidateField(
            <span class="hljs-string">"institucion"</span>
          );
          $.each(data, <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">key, val</span>) </span>{
            <span class="hljs-keyword">if</span> (val.text.search(regex) != <span class="hljs-number">-1</span>) {
              output += <span class="hljs-string">`&lt;a class="list-item" id="span_institucion" data-id="<span class="hljs-subst">${val.id}</span>"&gt;<span class="hljs-subst">${val.text}</span>`</span>;
              <span class="hljs-keyword">if</span> (count % <span class="hljs-number">2</span> == <span class="hljs-number">0</span>) {
                output += <span class="hljs-string">"&lt;/a&gt;"</span>;
              }
              count++;
            }
          });
          output += <span class="hljs-string">"&lt;/div&gt;"</span>;
          $(<span class="hljs-string">"#result_institucion"</span>).html(output);
        } <span class="hljs-keyword">else</span> {
          fv.enableValidator(<span class="hljs-string">"institucion"</span>, <span class="hljs-string">"noExiste"</span>).revalidateField(
            <span class="hljs-string">"institucion"</span>
          );
          $(<span class="hljs-string">"#result_institucion"</span>).html(<span class="hljs-string">""</span>);
          $(<span class="hljs-string">"#helpInstitucion"</span>).html(<span class="hljs-string">""</span>);
          $(<span class="hljs-string">"#helpInstitucion"</span>).removeClass(<span class="hljs-string">"is-success"</span>);
          $(<span class="hljs-string">"#helpInstitucion"</span>).addClass(<span class="hljs-string">"is-danger"</span>);
        }
      });
    } <span class="hljs-keyword">else</span> {
      <span class="hljs-keyword">if</span> (searchField.length + <span class="hljs-number">1</span> &lt; minlength) {
        $(<span class="hljs-string">"#result_institucion"</span>).html(<span class="hljs-string">""</span>);
      }
    }
  });

  $(<span class="hljs-built_in">document</span>).on(<span class="hljs-string">"click"</span>, <span class="hljs-string">"#span_institucion"</span>, <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) </span>{
    <span class="hljs-keyword">var</span> idInstitucion = $(<span class="hljs-keyword">this</span>).attr(<span class="hljs-string">"data-id"</span>).toLowerCase();
    <span class="hljs-keyword">var</span> n_institucion = $(<span class="hljs-keyword">this</span>).text();
    $(<span class="hljs-string">"#institucion"</span>).data(<span class="hljs-string">"id"</span>, idInstitucion);
    $(<span class="hljs-string">"#institucion"</span>).val(n_institucion);
    $(<span class="hljs-string">"#institucionSelected"</span>).val(n_institucion);
    <span class="hljs-keyword">if</span> ($(<span class="hljs-string">"#institucion"</span>).val() == n_institucion) {
      fv.disableValidator(<span class="hljs-string">"institucion"</span>, <span class="hljs-string">"noExiste"</span>).revalidateField(
        <span class="hljs-string">"institucion"</span>
      );
      $(<span class="hljs-string">"#helpInstitucion"</span>).html(<span class="hljs-string">""</span>);
    } <span class="hljs-keyword">else</span> {
      fv.enableValidator(<span class="hljs-string">"institucion"</span>, <span class="hljs-string">"noExiste"</span>).revalidateField(
        <span class="hljs-string">"institucion"</span>
      );
    }
    $(<span class="hljs-string">"#result_institucion"</span>).html(<span class="hljs-string">""</span>);
  });
}

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">l_set_select_presentacion</span>(<span class="hljs-params">$producto</span>) </span>{
  $.getJSON(
    aplicacion + <span class="hljs-string">"/ajax/ajx.presentacion.php"</span>,
    { <span class="hljs-attr">oper</span>: <span class="hljs-string">"getPresentacion"</span>, <span class="hljs-attr">producto</span>: $producto },
    <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">data</span>) </span>{
      <span class="hljs-keyword">var</span> items = [];
      $.each(data, <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">key, val</span>) </span>{
        items.push(<span class="hljs-string">"&lt;option value='"</span> + val.id + <span class="hljs-string">"'&gt;"</span> + val.valor + <span class="hljs-string">"&lt;/option&gt;"</span>);
      });
      $(<span class="hljs-string">"#presentacion"</span>).append(items);
    }
  );
}

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">getCurrentHostname</span>(<span class="hljs-params"></span>) </span>{
  <span class="hljs-keyword">var</span> protocolo, url, var_port, port;

  protocolo = <span class="hljs-built_in">window</span>.location.protocol;
  url = <span class="hljs-built_in">window</span>.location.hostname;
  var_port = <span class="hljs-built_in">window</span>.location.port;

  <span class="hljs-keyword">if</span> (var_port !== <span class="hljs-string">""</span>) {
    port = <span class="hljs-string">":"</span> + var_port;
  } <span class="hljs-keyword">else</span> {
    port = <span class="hljs-string">""</span>;
  }

  <span class="hljs-keyword">return</span> protocolo + <span class="hljs-string">"//"</span> + url + port;
}

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">getUrlHTTP</span>(<span class="hljs-params"></span>) </span>{
  <span class="hljs-keyword">var</span> path = <span class="hljs-built_in">window</span>.location.pathname;
  <span class="hljs-keyword">var</span> appName = path.split(<span class="hljs-string">"/"</span>);
  <span class="hljs-keyword">return</span> appName[<span class="hljs-number">1</span>];
}</pre></div></div>
            
        </li>
        
    </ul>
  </div>
</body>
</html>
