<!DOCTYPE html>

<html>
<head>
  <title>paciente.js</title>
  <meta http-equiv="content-type" content="text/html; charset=UTF-8">
  <meta name="viewport" content="width=device-width, target-densitydpi=160dpi, initial-scale=1.0; maximum-scale=1.0; user-scalable=0;">
  <link rel="stylesheet" media="all" href="docco.css" />
</head>
<body>
  <div id="container">
    <div id="background"></div>
    
      <ul id="jump_to">
        <li>
          <a class="large" href="javascript:void(0);">Jump To &hellip;</a>
          <a class="small" href="javascript:void(0);">+</a>
          <div id="jump_wrapper">
          <div id="jump_page_wrapper">
            <div id="jump_page">
              
                
                <a class="source" href="a_dosis.html">
                  a_dosis.js
                </a>
              
                
                <a class="source" href="a_esp.html">
                  a_esp.js
                </a>
              
                
                <a class="source" href="a_unidad.html">
                  a_unidad.js
                </a>
              
                
                <a class="source" href="adm_reasignar.html">
                  adm_reasignar.js
                </a>
              
                
                <a class="source" href="adm_regs.html">
                  adm_regs.js
                </a>
              
                
                <a class="source" href="adm_regs_docsedit.html">
                  adm_regs_docsedit.js
                </a>
              
                
                <a class="source" href="adm_regs_edit.html">
                  adm_regs_edit.js
                </a>
              
                
                <a class="source" href="apm.html">
                  apm.js
                </a>
              
                
                <a class="source" href="apms.html">
                  apms.js
                </a>
              
                
                <a class="source" href="canal.html">
                  canal.js
                </a>
              
                
                <a class="source" href="canales.html">
                  canales.js
                </a>
              
                
                <a class="source" href="clientes.html">
                  clientes.js
                </a>
              
                
                <a class="source" href="control_venta.html">
                  control_venta.js
                </a>
              
                
                <a class="source" href="datos_pac.html">
                  datos_pac.js
                </a>
              
                
                <a class="source" href="defa.html">
                  defa.js
                </a>
              
                
                <a class="source" href="diff_med.html">
                  diff_med.js
                </a>
              
                
                <a class="source" href="docs_canales.html">
                  docs_canales.js
                </a>
              
                
                <a class="source" href="docs_hist_medico.html">
                  docs_hist_medico.js
                </a>
              
                
                <a class="source" href="docs_hist_paciente.html">
                  docs_hist_paciente.js
                </a>
              
                
                <a class="source" href="docs_medico.html">
                  docs_medico.js
                </a>
              
                
                <a class="source" href="docs_paciente.html">
                  docs_paciente.js
                </a>
              
                
                <a class="source" href="dosis.html">
                  dosis.js
                </a>
              
                
                <a class="source" href="especialidades.html">
                  especialidades.js
                </a>
              
                
                <a class="source" href="funciones.html">
                  funciones.js
                </a>
              
                
                <a class="source" href="generar_venta.html">
                  generar_venta.js
                </a>
              
                
                <a class="source" href="get_apm_info.html">
                  get_apm_info.js
                </a>
              
                
                <a class="source" href="informes.html">
                  informes.js
                </a>
              
                
                <a class="source" href="informes_docs_nue_pres.html">
                  informes_docs_nue_pres.js
                </a>
              
                
                <a class="source" href="informes_nue_pres.html">
                  informes_nue_pres.js
                </a>
              
                
                <a class="source" href="institucion.html">
                  institucion.js
                </a>
              
                
                <a class="source" href="instituciones.html">
                  instituciones.js
                </a>
              
                
                <a class="source" href="listado.html">
                  listado.js
                </a>
              
                
                <a class="source" href="listado_details.html">
                  listado_details.js
                </a>
              
                
                <a class="source" href="log.html">
                  log.js
                </a>
              
                
                <a class="source" href="log_accesos.html">
                  log_accesos.js
                </a>
              
                
                <a class="source" href="login.html">
                  login.js
                </a>
              
                
                <a class="source" href="medico.html">
                  medico.js
                </a>
              
                
                <a class="source" href="medicos.html">
                  medicos.js
                </a>
              
                
                <a class="source" href="modificar_venta.html">
                  modificar_venta.js
                </a>
              
                
                <a class="source" href="nueva_venta.html">
                  nueva_venta.js
                </a>
              
                
                <a class="source" href="paciente.html">
                  paciente.js
                </a>
              
                
                <a class="source" href="pacientes.html">
                  pacientes.js
                </a>
              
                
                <a class="source" href="panel.html">
                  panel.js
                </a>
              
                
                <a class="source" href="panel_mod.html">
                  panel_mod.js
                </a>
              
                
                <a class="source" href="patologia.html">
                  patologia.js
                </a>
              
                
                <a class="source" href="patologias.html">
                  patologias.js
                </a>
              
                
                <a class="source" href="reasignados.html">
                  reasignados.js
                </a>
              
                
                <a class="source" href="reasignar.html">
                  reasignar.js
                </a>
              
                
                <a class="source" href="reporte_360.html">
                  reporte_360.js
                </a>
              
                
                <a class="source" href="reporte_ANMAT.html">
                  reporte_ANMAT.js
                </a>
              
                
                <a class="source" href="reporte_docs_paciente.html">
                  reporte_docs_paciente.js
                </a>
              
                
                <a class="source" href="reporte_filtros.html">
                  reporte_filtros.js
                </a>
              
                
                <a class="source" href="reporte_grilla.html">
                  reporte_grilla.js
                </a>
              
                
                <a class="source" href="reporte_productos.html">
                  reporte_productos.js
                </a>
              
                
                <a class="source" href="reporte_reasignaciones.html">
                  reporte_reasignaciones.js
                </a>
              
                
                <a class="source" href="reporte_ventas.html">
                  reporte_ventas.js
                </a>
              
                
                <a class="source" href="reporte_ventas_apm.html">
                  reporte_ventas_apm.js
                </a>
              
                
                <a class="source" href="reporte_ventas_paciente.html">
                  reporte_ventas_paciente.js
                </a>
              
                
                <a class="source" href="reportes_panel.html">
                  reportes_panel.js
                </a>
              
                
                <a class="source" href="seguridad.html">
                  seguridad.js
                </a>
              
                
                <a class="source" href="unidades.html">
                  unidades.js
                </a>
              
                
                <a class="source" href="usuario.html">
                  usuario.js
                </a>
              
                
                <a class="source" href="usuarios.html">
                  usuarios.js
                </a>
              
            </div>
          </div>
        </li>
      </ul>
    
    <ul class="sections">
        
          <li id="title">
              <div class="annotation">
                  <h1>paciente.js</h1>
              </div>
          </li>
        
        
        
        <li id="section-1">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-1">&#182;</a>
              </div>
              
            </div>
            
            <div class="content"><div class='highlight'><pre><span class="hljs-keyword">var</span> aplicacion = getCurrentHostname() + <span class="hljs-string">"/"</span> + getUrlHTTP();
<span class="hljs-keyword">var</span> paramPaciente = <span class="hljs-built_in">JSON</span>.parse(<span class="hljs-built_in">window</span>.localStorage.getItem(<span class="hljs-string">"paramPaciente"</span>));
<span class="hljs-keyword">var</span> usuario = <span class="hljs-built_in">JSON</span>.parse(<span class="hljs-built_in">window</span>.localStorage.getItem(<span class="hljs-string">"usuario"</span>));

$.getScript(aplicacion + <span class="hljs-string">"/resources/JS/funciones.min.js"</span>, <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) </span>{</pre></div></div>
            
        </li>
        
        
        <li id="section-2">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-2">&#182;</a>
              </div>
              <p>script is now loaded and executed.
put your dependent JS here.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>
  $(<span class="hljs-built_in">document</span>).ready(<span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) </span>{
    l_set_dom();

    $.fn.ajaxSelectPicker.locale[<span class="hljs-string">"es-ES"</span>] = {
      <span class="hljs-attr">currentlySelected</span>: <span class="hljs-string">"Seleccionado"</span>,
      <span class="hljs-attr">emptyTitle</span>: <span class="hljs-string">"Seleccione y comience a escribir"</span>,
      <span class="hljs-attr">errorText</span>: <span class="hljs-string">"No se puede recuperar resultados"</span>,
      <span class="hljs-attr">searchPlaceholder</span>: <span class="hljs-string">"Buscar..."</span>,
      <span class="hljs-attr">statusInitialized</span>: <span class="hljs-string">"Empieza a escribir una consulta de búsqueda"</span>,
      <span class="hljs-attr">statusNoResults</span>: <span class="hljs-string">"Sin Resultados"</span>,
      <span class="hljs-attr">statusSearching</span>: <span class="hljs-string">"Buscando..."</span>,
      <span class="hljs-attr">statusTooShort</span>: <span class="hljs-string">"Introduzca más caracteres"</span>,
    };

    $.fn.ajaxSelectPicker.locale.es = $.fn.ajaxSelectPicker.locale[<span class="hljs-string">"es-ES"</span>];

    $(<span class="hljs-string">".date"</span>).datepicker({
      <span class="hljs-attr">format</span>: <span class="hljs-string">"dd-mm-yyyy"</span>,
      <span class="hljs-attr">language</span>: <span class="hljs-string">"es"</span>,
      <span class="hljs-attr">endDate</span>: getDate(),
      <span class="hljs-attr">calendarWeeks</span>: <span class="hljs-literal">true</span>,
      <span class="hljs-attr">autoclose</span>: <span class="hljs-literal">true</span>,
      <span class="hljs-attr">clearBtn</span>: <span class="hljs-literal">true</span>,
      <span class="hljs-attr">todayHighlight</span>: <span class="hljs-literal">true</span>,
    });

    $(<span class="hljs-string">"#patologia"</span>).on(<span class="hljs-string">"changed.bs.select"</span>, <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">
      e,
      clickedIndex,
      isSelected,
      previousValue
    </span>) </span>{
      l_hide_selectpicker_sub_pat();
      l_list_sub_patologia(
        <span class="hljs-literal">null</span>,
        <span class="hljs-keyword">this</span>.value,
        $(<span class="hljs-string">"#patologia option:selected"</span>).text()
      );
    });

    <span class="hljs-keyword">if</span> (getQuerystring(<span class="hljs-string">"id"</span>) === <span class="hljs-string">""</span>) {
      <span class="hljs-built_in">document</span>.getElementById(<span class="hljs-string">"masculino"</span>).checked = <span class="hljs-literal">true</span>;
    } <span class="hljs-keyword">else</span> {
      $(<span class="hljs-string">"#bot_guardar"</span>).removeClass(<span class="hljs-string">"disabled"</span>);
    }

    $(<span class="hljs-string">"#f_nac"</span>).on(<span class="hljs-string">"change"</span>, <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) </span>{
      $(<span class="hljs-string">"#f_edad"</span>).val(l_calcular_edad(<span class="hljs-keyword">this</span>.value));
      $(<span class="hljs-string">".form"</span>).formValidation(<span class="hljs-string">"revalidateField"</span>, <span class="hljs-string">"f_nac"</span>);
    });

    $(<span class="hljs-string">"#editDocs"</span>).click(<span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) </span>{
      <span class="hljs-built_in">window</span>.location.href =
        aplicacion +
        <span class="hljs-string">"/administrador/docs_paciente.php?id="</span> +
        getQuerystring(<span class="hljs-string">"id"</span>);
    });
    $(<span class="hljs-string">"#histDocs"</span>).click(<span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) </span>{
      <span class="hljs-built_in">window</span>.location.href =
        <span class="hljs-string">"../vistas/paciente/docs_hist_paciente.php?id="</span> +
        getQuerystring(<span class="hljs-string">"id"</span>) +
        <span class="hljs-string">"&amp;nombre="</span> +
        ($(<span class="hljs-string">"#apellido"</span>).val() + <span class="hljs-string">", "</span> + $(<span class="hljs-string">"#nombre"</span>).val());
    });
    $(<span class="hljs-string">"#confirmar_pac"</span>).click(<span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">e</span>) </span>{
      e.preventDefault();
      l_dictamen_paciente();
    });
  });
});

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">l_dictamen_paciente</span>(<span class="hljs-params"></span>) </span>{
  <span class="hljs-keyword">var</span> data = $(<span class="hljs-string">"#frmDictamenPac"</span>).serializeArray();
  data.push({ <span class="hljs-attr">name</span>: <span class="hljs-string">"oper"</span>, <span class="hljs-attr">value</span>: <span class="hljs-string">"ValidaPac"</span> });
  data.push({
    <span class="hljs-attr">name</span>: <span class="hljs-string">"idPac"</span>,
    <span class="hljs-attr">value</span>: <span class="hljs-built_in">document</span>.getElementById(<span class="hljs-string">"idPac"</span>).innerHTML,
  });

  $.post(<span class="hljs-string">"../ajax/ajx.paciente_form.php"</span>, data, <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">data</span>) </span>{
    l_mail_dictamenPaciente(<span class="hljs-built_in">document</span>.getElementById(<span class="hljs-string">"idPac"</span>).innerHTML);
    <span class="hljs-built_in">window</span>.location.href = aplicacion + <span class="hljs-string">"/main/panel.php"</span>;
  });
}

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">l_set_paciente</span>(<span class="hljs-params"></span>) </span>{
  $.ajax({
    <span class="hljs-attr">type</span>: <span class="hljs-string">"POST"</span>,
    <span class="hljs-attr">url</span>: <span class="hljs-string">"../ajax/ajx.paciente.php"</span>,
    <span class="hljs-attr">data</span>: { <span class="hljs-attr">id</span>: getQuerystring(<span class="hljs-string">"id"</span>), <span class="hljs-attr">oper</span>: <span class="hljs-string">"showPaciente"</span> },
    <span class="hljs-attr">success</span>: <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">response</span>) </span>{
      $.map($.parseJSON(response), <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">e, i</span>) </span>{
        <span class="hljs-keyword">if</span> (usuario.grupo == <span class="hljs-string">"fv"</span> || usuario.grupo == <span class="hljs-string">"admin"</span>) {
          $(<span class="hljs-string">"#nombrePac"</span>).html(e.apellido + <span class="hljs-string">" "</span> + e.nombre);
          $(<span class="hljs-string">"#apellido"</span>).val(e.apellido);
          $(<span class="hljs-string">"#nombre"</span>).val(e.nombre);
          $(<span class="hljs-string">"#idPac"</span>).html(e.id);
          $(<span class="hljs-string">"#estadoPac"</span>).html(e.estado_valor);
          l_set_hero_style(e.estado_id);
          l_sub_estado(e.sub_estado_id);
          $(<span class="hljs-string">"#fechaNacPac"</span>).html(e.fecha_nac_formateada);
          $(<span class="hljs-string">"#f_edad"</span>).html(l_calcular_edad(e.fecha_nac_formateada));
          e.telefono === <span class="hljs-string">"NULL"</span>
            ? $(<span class="hljs-string">"#telPac"</span>).html(<span class="hljs-string">"-"</span>)
            : $(<span class="hljs-string">"#telPac"</span>).html(e.telefono);
          e.ciudad == <span class="hljs-string">"NULL"</span>
            ? $(<span class="hljs-string">"#ciudadPac"</span>).html(<span class="hljs-string">"-"</span>)
            : $(<span class="hljs-string">"#ciudadPac"</span>).html(e.ciudad);
          $(<span class="hljs-string">"#paisPac"</span>).html(e.pais_nombre);
          e.mail == <span class="hljs-string">"NULL"</span>
            ? $(<span class="hljs-string">"#emailPac"</span>).html(<span class="hljs-string">"-"</span>)
            : $(<span class="hljs-string">"#emailPac"</span>).html(e.mail);
          $(<span class="hljs-string">"#sexoPac"</span>).html(e.sexo);
          $(<span class="hljs-string">"#osPac"</span>).html(e.os_nombre);
          $(<span class="hljs-string">"crmId"</span>).html(e.crm_id);
          $(<span class="hljs-string">"#patPac"</span>).html(e.patologiaNombre);
          $(<span class="hljs-string">"#subPatPac"</span>).html(e.subPatologiaNombre);
          $(<span class="hljs-string">"#usuarioCreador"</span>).html(e.usuario_creador);
          $(<span class="hljs-string">"#fechaCreacion"</span>).html(e.fecha_creacion);</pre></div></div>
            
        </li>
        
        
        <li id="section-3">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-3">&#182;</a>
              </div>
              <p>Verifico si el usuario tiene notas creadas y las muestro
Sino no despliego el div de notas</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>          e.notas === <span class="hljs-string">""</span>
            ? l_estado_dictamen(e.estado_valor)
            : l_estado_dictamen(
                e.estado_valor,
                e.notas,
                e.usuario_mod,
                e.fecha_modificacion
              );
          l_list_estado(e.estado_id);
        } <span class="hljs-keyword">else</span> {
          l_show_id(e.id);
          $(<span class="hljs-string">"#idPac"</span>).html(e.id);
          $(<span class="hljs-string">"#apellido"</span>).val(e.apellido);
          $(<span class="hljs-string">"#nombre"</span>).val(e.nombre);
          $(<span class="hljs-string">"#f_nac"</span>).val(e.fecha_nac_formateada);
          $(<span class="hljs-string">"#f_edad"</span>).val(l_calcular_edad(e.fecha_nac_formateada));
          e.sexo == <span class="hljs-string">"M"</span>
            ? $(<span class="hljs-string">"#masculino"</span>).attr(<span class="hljs-string">"checked"</span>, <span class="hljs-string">"checked"</span>)
            : $(<span class="hljs-string">"#femenino"</span>).attr(<span class="hljs-string">"checked"</span>, <span class="hljs-string">"checked"</span>);
          $(<span class="hljs-string">"#telefono"</span>).val(e.telefono);
          $(<span class="hljs-string">"#ciudad"</span>).val(e.ciudad);
          l_list_paises(<span class="hljs-literal">true</span>, e.pais_id, e.pais_nombre);
          $(<span class="hljs-string">"#mail"</span>).val(e.mail);
          l_get_estado(e.estado_id);
          e.estado_id === <span class="hljs-string">"7"</span>
            ? l_estado_dictamen(e.estado_valor)
            : l_estado_dictamen(e.estado_valor, e.notas, e.usuario_mod);
          l_sub_estado(e.sub_estado_id);
          l_list_patologias(e.patologia_id);
          e.sub_patologia_id !== <span class="hljs-string">"4"</span>
            ? l_list_sub_patologia(e.sub_patologia_id, e.patologia_id, <span class="hljs-literal">null</span>)
            : $(<span class="hljs-string">"#div-sub_pat"</span>).hide();
          l_list_os(<span class="hljs-literal">true</span>, e.os_id, e.os_nombre);
          $(<span class="hljs-string">"#crm_id"</span>).val(e.crm_id);
        }
      });
    },
  });
}

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">l_show_id</span>(<span class="hljs-params">$id</span>) </span>{
  $(<span class="hljs-string">"#div_paciente_id"</span>).show();
  $(<span class="hljs-string">"#vw_id"</span>).val($id);
}

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">l_get_estado</span>(<span class="hljs-params">$estado_id</span>) </span>{
  $.getJSON(<span class="hljs-string">"../ajax/ajx.estado.php"</span>, { <span class="hljs-attr">oper</span>: <span class="hljs-string">"getEstado"</span> }, <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">data</span>) </span>{
    $.map(data, <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">e, i</span>) </span>{
      <span class="hljs-keyword">if</span> ($estado_id == e.id) $(<span class="hljs-string">"#estado"</span>).val(e.valor);
    });
  });
}

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">openFile</span>(<span class="hljs-params">e</span>) </span>{
  urlImagen = aplicacion + <span class="hljs-string">"/documentacion/"</span> + e;

  <span class="hljs-built_in">window</span>.open(urlImagen);
}

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">l_set_hero_style</span>(<span class="hljs-params">$estado_id</span>) </span>{
  <span class="hljs-keyword">switch</span> ($estado_id) {
    <span class="hljs-keyword">case</span> <span class="hljs-string">"7"</span>:
      $<span class="hljs-class"><span class="hljs-keyword">class</span> </span>= <span class="hljs-string">"is-warning"</span>;
      <span class="hljs-keyword">break</span>;
    <span class="hljs-keyword">case</span> <span class="hljs-string">"11"</span>:
      $<span class="hljs-class"><span class="hljs-keyword">class</span> </span>= <span class="hljs-string">"is-success"</span>;
      <span class="hljs-keyword">break</span>;
    <span class="hljs-keyword">case</span> <span class="hljs-string">"12"</span>:
      $<span class="hljs-class"><span class="hljs-keyword">class</span> </span>= <span class="hljs-string">"is-danger"</span>;
      <span class="hljs-keyword">break</span>;
    <span class="hljs-keyword">case</span> <span class="hljs-string">"13"</span>:
      $<span class="hljs-class"><span class="hljs-keyword">class</span> </span>= <span class="hljs-string">"is-danger"</span>;
      <span class="hljs-keyword">break</span>;
    <span class="hljs-keyword">default</span>:
      <span class="hljs-keyword">break</span>;
  }
  $(<span class="hljs-string">"#heroHeadPac"</span>).addClass($<span class="hljs-class"><span class="hljs-keyword">class</span>)</span>;
}

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">l_estado_dictamen</span>(<span class="hljs-params">
  $estadoValor,
  $notas = null,
  $usuario_mod,
  $fecha_modificacion
</span>) </span>{
  $(<span class="hljs-string">"#estadoDictamen"</span>).show();
  $(<span class="hljs-string">"#estado"</span>).prop(<span class="hljs-string">"disabled"</span>, <span class="hljs-literal">true</span>);

  <span class="hljs-keyword">if</span> (usuario.grupo === <span class="hljs-string">"fv"</span> || usuario.grupo === <span class="hljs-string">"admin"</span>) {
    <span class="hljs-keyword">const</span> content = <span class="hljs-string">`
        &lt;nav class="level"&gt;
            &lt;div class="level-item has-text-centered"&gt;
                &lt;div&gt;
                    &lt;p class="heading"&gt;Ultima Nota&lt;/p&gt;
                    &lt;p class="subtitle"&gt;<span class="hljs-subst">${$notas}</span>&lt;/p&gt;
                &lt;/div&gt;
            &lt;/div&gt;
        &lt;/nav&gt;
        &lt;br&gt;
        &lt;div class="container has-text-centered"&gt;
            &lt;div class="tags has-addons are-small"&gt;
                &lt;span class="tag is-dark"&gt;<span class="hljs-subst">${$usuario_mod}</span>&lt;/span&gt;
                &lt;span class="tag is-info"&gt;<span class="hljs-subst">${$fecha_modificacion}</span>&lt;/span&gt;
            &lt;/div&gt;
        &lt;/div&gt;
        `</span>;
    $notas === <span class="hljs-literal">null</span> ? <span class="hljs-string">""</span> : $(<span class="hljs-string">"#ultimaNota"</span>).html(content);
  } <span class="hljs-keyword">else</span> {
    <span class="hljs-keyword">switch</span> ($estadoValor) {
      <span class="hljs-keyword">case</span> <span class="hljs-string">"Pendiente"</span>:
        $<span class="hljs-class"><span class="hljs-keyword">class</span> </span>= <span class="hljs-string">"alert-warning"</span>;
        <span class="hljs-keyword">break</span>;
      <span class="hljs-keyword">case</span> <span class="hljs-string">"Aprobado"</span>:
        $<span class="hljs-class"><span class="hljs-keyword">class</span> </span>= <span class="hljs-string">"alert-success"</span>;
        <span class="hljs-keyword">break</span>;
      <span class="hljs-keyword">case</span> <span class="hljs-string">"Baja"</span>:
        $<span class="hljs-class"><span class="hljs-keyword">class</span> </span>= <span class="hljs-string">"alert-danger"</span>;
        <span class="hljs-keyword">break</span>;
      <span class="hljs-keyword">case</span> <span class="hljs-string">"Rechazado"</span>:
        $<span class="hljs-class"><span class="hljs-keyword">class</span> </span>= <span class="hljs-string">"alert-danger"</span>;
        <span class="hljs-keyword">break</span>;
      <span class="hljs-keyword">default</span>:
        $<span class="hljs-class"><span class="hljs-keyword">class</span> </span>= <span class="hljs-string">"alert-info"</span>;
        <span class="hljs-keyword">break</span>;
    }
    <span class="hljs-keyword">const</span> content = <span class="hljs-string">`
                &lt;div class="alert <span class="hljs-subst">${$class}</span>" role="alert"&gt;
                    &lt;p&gt;Paciente en estado: &lt;b&gt;"<span class="hljs-subst">${$estadoValor}</span>" &lt;/b&gt;&lt;/p&gt;
                    <span class="hljs-subst">${$notas ? <span class="hljs-string">"&lt;p&gt;Motivo:&lt;i&gt; "</span> + $notas + <span class="hljs-string">"&lt;/i&gt;&lt;/p&gt;"</span> : <span class="hljs-string">""</span>}</span>
                    <span class="hljs-subst">${
                      $usuario_mod !== <span class="hljs-literal">undefined</span>
                        ? <span class="hljs-string">`&lt;p&gt;Nota creada por: &lt;b&gt;<span class="hljs-subst">${$usuario_mod}</span>&lt;/b&gt;&lt;/p&gt;`</span>
                        : <span class="hljs-string">""</span>
                    }</span>
                &lt;/div&gt;
        `</span>;

    $(<span class="hljs-string">"#estadoDictamen"</span>).html(content);
  }
}

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">l_list_estado</span>(<span class="hljs-params">$estado_id</span>) </span>{
  $.getJSON(<span class="hljs-string">"../ajax/ajx.estado.php"</span>, { <span class="hljs-attr">oper</span>: <span class="hljs-string">"getEstado"</span> }, <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">data</span>) </span>{
    $.map(data, <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">e, i</span>) </span>{</pre></div></div>
            
        </li>
        
        
        <li id="section-4">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-4">&#182;</a>
              </div>
              <p>NOTE se verifica que si el estado es sin Documentacion o Pendiente no pueda ser seleccionado</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>      <span class="hljs-keyword">if</span> (e.id == <span class="hljs-string">"7"</span> || e.id === <span class="hljs-string">"31"</span>) {
        $(<span class="hljs-string">"#estadoList"</span>).append(
          <span class="hljs-string">"&lt;option value="</span> + e.id + <span class="hljs-string">" disabled&gt;"</span> + e.valor + <span class="hljs-string">"&lt;/option&gt;"</span>
        );
      } <span class="hljs-keyword">else</span> {
        $(<span class="hljs-string">"#estadoList"</span>).append(
          <span class="hljs-string">"&lt;option value="</span> + e.id + <span class="hljs-string">"&gt;"</span> + e.valor + <span class="hljs-string">"&lt;/option&gt;"</span>
        );
      }
      <span class="hljs-keyword">if</span> (e.id == $estado_id) {
        $(<span class="hljs-string">"#estadoList"</span>).selectpicker(<span class="hljs-string">"val"</span>, e.id);
      }

      $(<span class="hljs-string">"#estadoList"</span>).selectpicker(<span class="hljs-string">"refresh"</span>);
    });
  });
}

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">l_sub_estado</span>(<span class="hljs-params">$sub_estado_id</span>) </span>{
  $.getJSON(<span class="hljs-string">"../ajax/ajx.sub_estado.php"</span>, { <span class="hljs-attr">oper</span>: <span class="hljs-string">"getSubEstado"</span> }, <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">
    data
  </span>) </span>{
    $.map(data, <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">e, i</span>) </span>{
      $(<span class="hljs-string">"#sub_estado"</span>).append(
        <span class="hljs-string">"&lt;option value="</span> + e.id + <span class="hljs-string">"&gt;"</span> + e.valor + <span class="hljs-string">"&lt;/option&gt;"</span>
      );
      $(<span class="hljs-string">"#sub_estado"</span>).selectpicker(<span class="hljs-string">"refresh"</span>);
      <span class="hljs-keyword">if</span> (e.id === $sub_estado_id) {
        usuario.grupo === <span class="hljs-string">"fv"</span> || usuario.grupo === <span class="hljs-string">"admin"</span>
          ? $(<span class="hljs-string">"#subEstadoPac"</span>).html(e.valor)
          : $(<span class="hljs-string">"#sub_estado"</span>).selectpicker(<span class="hljs-string">"val"</span>, e.valor);
      }
    });
  });
}

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">l_calcular_edad</span>(<span class="hljs-params">fecha</span>) </span>{
  <span class="hljs-comment">/**The magic number: 31557600000 is 24 * 3600 * 365.25 * 1000 
   * Which is the length of a year, the length of a year is 365 days and 6 hours which is 0.25 day. 
   * In the end i floor the result which gives us the final age.
  https://stackoverflow.com/questions/4060004/calculate-age-given-the-birth-date-in-the-format-yyyymmdd
 */</span>

  <span class="hljs-keyword">var</span> array_fecha = fecha.split(<span class="hljs-string">"-"</span>);
  <span class="hljs-keyword">let</span> dateFormat = array_fecha[<span class="hljs-number">2</span>] + <span class="hljs-string">"-"</span> + array_fecha[<span class="hljs-number">1</span>] + <span class="hljs-string">"-"</span> + array_fecha[<span class="hljs-number">0</span>];
  <span class="hljs-keyword">var</span> birthday = +<span class="hljs-keyword">new</span> <span class="hljs-built_in">Date</span>(dateFormat);
  <span class="hljs-keyword">return</span> ~~((<span class="hljs-built_in">Date</span>.now() - birthday) / <span class="hljs-number">31557600000</span>);
}

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">l_list_patologias</span>(<span class="hljs-params">$patologia_id = null</span>) </span>{
  $.getJSON(<span class="hljs-string">"../ajax/ajx.patologia.php"</span>, { <span class="hljs-attr">oper</span>: <span class="hljs-string">"list_patologias"</span> }, <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">
    data
  </span>) </span>{
    $.map(data, <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">e, i</span>) </span>{
      $(<span class="hljs-string">"#patologia"</span>).append(
        <span class="hljs-string">"&lt;option value="</span> + e.id + <span class="hljs-string">"&gt;"</span> + e.patologia_nombre + <span class="hljs-string">"&lt;/option&gt;"</span>
      );
      $(<span class="hljs-string">"#patologia"</span>).selectpicker(<span class="hljs-string">"refresh"</span>);
      <span class="hljs-keyword">if</span> (e.id == $patologia_id) {
        $(<span class="hljs-string">"#patologia"</span>).selectpicker(<span class="hljs-string">"val"</span>, e.id);
      }
    });
  });
}

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">l_list_sub_patologia</span>(<span class="hljs-params">
  $sub_patologia_id = null,
  $patologia_id,
  $patologia_nombre
</span>) </span>{
  $(<span class="hljs-string">"#sub_patologia"</span>).empty();
  $(<span class="hljs-string">"#sub_patologia"</span>).selectpicker(<span class="hljs-string">"refresh"</span>);

  $.get(
    <span class="hljs-string">"../ajax/ajx.sub_patologia.php"</span>,
    { <span class="hljs-attr">oper</span>: <span class="hljs-string">"list_sub_patologia"</span>, <span class="hljs-attr">patologia_id</span>: $patologia_id },
    <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">data</span>) </span>{
      <span class="hljs-keyword">if</span> (data !== <span class="hljs-number">0</span>) {
        l_hide_selectpicker_sub_pat(<span class="hljs-literal">false</span>);
        $(<span class="hljs-string">"#sub_patologia"</span>).append(
          <span class="hljs-string">'&lt;option value="" selected &gt;Seleccione una Sub Patología&lt;/option&gt;'</span>
        );
        $.map(data, <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">e, i</span>) </span>{
          $(<span class="hljs-string">"#sub_patologia"</span>).append(
            <span class="hljs-string">"&lt;option data-subtext="</span> +
              $patologia_nombre +
              <span class="hljs-string">" value="</span> +
              e.id +
              <span class="hljs-string">"&gt;"</span> +
              e.sub_patologia_nombre +
              <span class="hljs-string">"&lt;/option&gt;"</span>
          );

          <span class="hljs-keyword">if</span> ($sub_patologia_id == e.id) {
            $(<span class="hljs-string">"#sub_patologia"</span>).selectpicker(<span class="hljs-string">"val"</span>, e.id);
          }

          $(<span class="hljs-string">"#sub_patologia"</span>).selectpicker(<span class="hljs-string">"refresh"</span>);
        });
      }
    },
    <span class="hljs-string">"json"</span>
  );
}

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">l_hide_selectpicker_sub_pat</span>(<span class="hljs-params">hide = true</span>) </span>{
  <span class="hljs-keyword">if</span> (hide) {
    $(<span class="hljs-string">"#div-sub_pat"</span>).hide();
  } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (hide == <span class="hljs-literal">false</span>) {
    $(<span class="hljs-string">"#div-sub_pat"</span>).show();
  }
}

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">l_list_paises</span>(<span class="hljs-params">$filter = null, $pais_id = null, $pais_nombre = null</span>) </span>{
  $(<span class="hljs-string">"#pais"</span>)
    .selectpicker()
    .ajaxSelectPicker({
      <span class="hljs-attr">ajax</span>: {</pre></div></div>
            
        </li>
        
        
        <li id="section-5">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-5">&#182;</a>
              </div>
              <p>data source</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>        url: <span class="hljs-string">"../ajax/ajx.paises.php"</span>,</pre></div></div>
            
        </li>
        
        
        <li id="section-6">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-6">&#182;</a>
              </div>
              <p>ajax type</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>        type: <span class="hljs-string">"POST"</span>,</pre></div></div>
            
        </li>
        
        
        <li id="section-7">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-7">&#182;</a>
              </div>
              <p>data type</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>        dataType: <span class="hljs-string">"json"</span>,
        <span class="hljs-attr">langCode</span>: <span class="hljs-string">"es"</span>,</pre></div></div>
            
        </li>
        
        
        <li id="section-8">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-8">&#182;</a>
              </div>
              <p>Use “{{{q}}}” as a placeholder and Ajax Bootstrap Select will
automatically replace it with the value of the search query.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>        data: {
          <span class="hljs-attr">q</span>: <span class="hljs-string">"{{{q}}}"</span>,
        },
      },</pre></div></div>
            
        </li>
        
        
        <li id="section-9">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-9">&#182;</a>
              </div>
              <p>function to preprocess JSON data</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>      preprocessData: <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">data</span>) </span>{
        <span class="hljs-keyword">var</span> i,
          l = data.length,
          array = [];
        <span class="hljs-keyword">if</span> (l) {
          <span class="hljs-keyword">for</span> (i = <span class="hljs-number">0</span>; i &lt; l; i++) {
            array.push(
              $.extend(<span class="hljs-literal">true</span>, data[i], {
                <span class="hljs-attr">text</span>: data[i].nombre,
                <span class="hljs-attr">value</span>: data[i].id,
              })
            );
          }
        }</pre></div></div>
            
        </li>
        
        
        <li id="section-10">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-10">&#182;</a>
              </div>
              <p>You must always return a valid array when processing data. The
data argument passed is a clone and cannot be modified directly.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>        <span class="hljs-keyword">return</span> array;
      },
    });
  <span class="hljs-keyword">if</span> ($filter) {
    $(<span class="hljs-string">"#pais.after-init"</span>)
      .append(
        <span class="hljs-string">'&lt;option value="'</span> +
          $pais_id +
          <span class="hljs-string">'" selected="selected"&gt;'</span> +
          $pais_nombre +
          <span class="hljs-string">"&lt;/option&gt;"</span>
      )
      .selectpicker(<span class="hljs-string">"refresh"</span>);
    $(<span class="hljs-string">"#pais.after-init"</span>).trigger(<span class="hljs-string">"change"</span>);
  } <span class="hljs-keyword">else</span> {
    $(<span class="hljs-string">"#pais.after-init"</span>)
      .append(<span class="hljs-string">'&lt;option value="13" selected="selected"&gt;Argentina&lt;/option&gt;'</span>)
      .selectpicker(<span class="hljs-string">"refresh"</span>);
    $(<span class="hljs-string">"#pais.after-init"</span>).trigger(<span class="hljs-string">"change"</span>);
  }
}

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">l_list_os</span>(<span class="hljs-params">$filter = null, $os_id = null, $os_nombre</span>) </span>{
  $(<span class="hljs-string">"#os"</span>)
    .selectpicker()
    .ajaxSelectPicker({
      <span class="hljs-attr">ajax</span>: {</pre></div></div>
            
        </li>
        
        
        <li id="section-11">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-11">&#182;</a>
              </div>
              <p>data source</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>        url: <span class="hljs-string">"../ajax/ajx.os.php"</span>,</pre></div></div>
            
        </li>
        
        
        <li id="section-12">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-12">&#182;</a>
              </div>
              <p>ajax type</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>        type: <span class="hljs-string">"POST"</span>,</pre></div></div>
            
        </li>
        
        
        <li id="section-13">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-13">&#182;</a>
              </div>
              <p>data type</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>        dataType: <span class="hljs-string">"json"</span>,
        <span class="hljs-attr">langCode</span>: <span class="hljs-string">"es"</span>,</pre></div></div>
            
        </li>
        
        
        <li id="section-14">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-14">&#182;</a>
              </div>
              <p>Use “{{{q}}}” as a placeholder and Ajax Bootstrap Select will
automatically replace it with the value of the search query.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>        data: {
          <span class="hljs-attr">q</span>: <span class="hljs-string">"{{{q}}}"</span>,
        },
      },</pre></div></div>
            
        </li>
        
        
        <li id="section-15">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-15">&#182;</a>
              </div>
              <p>function to preprocess JSON data</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>      preprocessData: <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">data</span>) </span>{
        <span class="hljs-keyword">var</span> i,
          l = data.length,
          array = [];
        <span class="hljs-keyword">if</span> (l) {
          <span class="hljs-keyword">for</span> (i = <span class="hljs-number">0</span>; i &lt; l; i++) {
            array.push(
              $.extend(<span class="hljs-literal">true</span>, data[i], {
                <span class="hljs-attr">text</span>: data[i].nombre,
                <span class="hljs-attr">value</span>: data[i].id,
              })
            );
          }
        }</pre></div></div>
            
        </li>
        
        
        <li id="section-16">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-16">&#182;</a>
              </div>
              <p>You must always return a valid array when processing data. The
data argument passed is a clone and cannot be modified directly.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>        <span class="hljs-keyword">return</span> array;
      },
    });
  <span class="hljs-keyword">if</span> ($filter) {
    $(<span class="hljs-string">"#os"</span>)
      .append(
        <span class="hljs-string">'&lt;option value="'</span> +
          $os_id +
          <span class="hljs-string">'" selected="selected"&gt;'</span> +
          $os_nombre +
          <span class="hljs-string">"&lt;/option&gt;"</span>
      )
      .selectpicker(<span class="hljs-string">"refresh"</span>);
    $(<span class="hljs-string">"#os"</span>).trigger(<span class="hljs-string">"change"</span>);
  }
}

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">l_validate_form</span>(<span class="hljs-params"></span>) </span>{
  $(<span class="hljs-string">".form"</span>)
    .formValidation({
      <span class="hljs-attr">framework</span>: <span class="hljs-string">"bootstrap"</span>,
      <span class="hljs-attr">excluded</span>: <span class="hljs-string">":disabled"</span>,
      <span class="hljs-attr">icon</span>: {
        <span class="hljs-attr">required</span>: <span class="hljs-string">"fa fa-asterisk"</span>,
        <span class="hljs-attr">valid</span>: <span class="hljs-string">"glyphicon glyphicon-ok"</span>,
        <span class="hljs-attr">invalid</span>: <span class="hljs-string">"glyphicon glyphicon-remove"</span>,
        <span class="hljs-attr">validating</span>: <span class="hljs-string">"glyphicon glyphicon-refresh"</span>,
      },
      <span class="hljs-attr">fields</span>: {
        <span class="hljs-attr">nombre</span>: {
          <span class="hljs-attr">message</span>: <span class="hljs-string">"El nombre del paciente no es válido"</span>,
          <span class="hljs-attr">validators</span>: {
            <span class="hljs-attr">notEmpty</span>: {
              <span class="hljs-attr">message</span>: <span class="hljs-string">"El nombre del paciente no puede quedar vacío"</span>,
            },
            <span class="hljs-attr">regexp</span>: {
              <span class="hljs-attr">regexp</span>: <span class="hljs-regexp">/^[a-zA-ZñÑáéíóúÁÉÍÓÚ\s]*$/</span>,
              message: <span class="hljs-string">"Este campo debe contener solo letras."</span>,
            },
            <span class="hljs-attr">stringLength</span>: {
              <span class="hljs-attr">min</span>: <span class="hljs-number">1</span>,
              <span class="hljs-attr">max</span>: <span class="hljs-number">100</span>,
              <span class="hljs-attr">message</span>:
                <span class="hljs-string">"El nombre del paciente debe contener como mínimo 1 y como máximo 100 letras"</span>,
            },
          },
        },
        <span class="hljs-attr">apellido</span>: {
          <span class="hljs-attr">message</span>: <span class="hljs-string">"El apellido del paciente no es válido"</span>,
          <span class="hljs-attr">validators</span>: {
            <span class="hljs-attr">notEmpty</span>: {
              <span class="hljs-attr">message</span>: <span class="hljs-string">"El apellido del paciente no puede quedar vacío"</span>,
            },
            <span class="hljs-attr">regexp</span>: {
              <span class="hljs-attr">regexp</span>: <span class="hljs-regexp">/^[a-zA-ZñÑáéíóúÁÉÍÓÚ\s]*$/</span>,
              message: <span class="hljs-string">"Este campo debe contener solo letras."</span>,
            },
            <span class="hljs-attr">stringLength</span>: {
              <span class="hljs-attr">min</span>: <span class="hljs-number">1</span>,
              <span class="hljs-attr">max</span>: <span class="hljs-number">100</span>,
              <span class="hljs-attr">message</span>:
                <span class="hljs-string">"El apellido del paciente debe contener como mínimo 1 y como máximo 100 letras"</span>,
            },
          },
        },
        <span class="hljs-attr">ciudad</span>: {
          <span class="hljs-attr">message</span>: <span class="hljs-string">"El nombre de la ciudad no es válida"</span>,
          <span class="hljs-attr">validators</span>: {
            <span class="hljs-attr">regexp</span>: {
              <span class="hljs-attr">regexp</span>: <span class="hljs-regexp">/^[0-9a-zA-ZñÑáéíóúÁÉÍÓÚ\s,]*$/</span>,
              message: <span class="hljs-string">"Este campo debe contener solo letras y/o números."</span>,
            },
            <span class="hljs-attr">stringLength</span>: {
              <span class="hljs-attr">min</span>: <span class="hljs-number">4</span>,
              <span class="hljs-attr">max</span>: <span class="hljs-number">100</span>,
              <span class="hljs-attr">message</span>:
                <span class="hljs-string">"Este campo debe contener como mínimo 4 y como máximo 100 letras"</span>,
            },
          },
        },
        <span class="hljs-attr">sub_estado</span>: {
          <span class="hljs-attr">validators</span>: {
            <span class="hljs-attr">notEmpty</span>: {
              <span class="hljs-attr">message</span>: <span class="hljs-string">"El Sub Estado del paciente no puede quedar vacío"</span>,
            },
          },
        },
        <span class="hljs-attr">patologia</span>: {
          <span class="hljs-attr">validators</span>: {
            <span class="hljs-attr">notEmpty</span>: {
              <span class="hljs-attr">message</span>: <span class="hljs-string">"La patologia del paciente no puede quedar vacía"</span>,
            },
          },
        },
        <span class="hljs-attr">pais</span>: {
          <span class="hljs-attr">validators</span>: {
            <span class="hljs-attr">notEmpty</span>: {
              <span class="hljs-attr">message</span>: <span class="hljs-string">"Debe seleccionar un país"</span>,
            },
          },
        },
        <span class="hljs-comment">/*estadoVal: {
                    validators: {
                        notEmpty: {
                            message: 'Debe Seleccionar una Opción'
                        }
                    }                            
                },*/</span>
        <span class="hljs-attr">mail</span>: {
          <span class="hljs-attr">validators</span>: {
            <span class="hljs-attr">emailAddress</span>: {
              <span class="hljs-attr">message</span>: <span class="hljs-string">"Por favor, ingrese una dirección de e-mail"</span>,
            },
            <span class="hljs-attr">regexp</span>: {
              <span class="hljs-attr">regexp</span>: <span class="hljs-regexp">/^\S+@\S+\.\S+$/</span>,
              message: <span class="hljs-string">"El formato del e-mail no es válido"</span>,
            },
          },
        },
        <span class="hljs-attr">f_nac</span>: {
          <span class="hljs-attr">validators</span>: {
            <span class="hljs-attr">date</span>: {
              <span class="hljs-attr">format</span>: <span class="hljs-string">"DD-MM-YYYY"</span>,
              <span class="hljs-attr">message</span>: <span class="hljs-string">"El formato es invalido"</span>,
            },
            <span class="hljs-attr">notEmpty</span>: {
              <span class="hljs-attr">message</span>:
                <span class="hljs-string">"La Fecha de Nacimiento del paciente no puede quedar vacía"</span>,
            },
          },
        },
        <span class="hljs-attr">telefono</span>: {
          <span class="hljs-attr">validators</span>: {
            <span class="hljs-attr">regexp</span>: {
              <span class="hljs-attr">regexp</span>: <span class="hljs-regexp">/^[0-9 -]+$/</span>,
              message:
                <span class="hljs-string">'Este campo debe contener solo números. Puede utilizar como separador el símbolo "-".'</span>,
            },
            <span class="hljs-attr">stringLength</span>: {
              <span class="hljs-attr">min</span>: <span class="hljs-number">8</span>,
              <span class="hljs-attr">message</span>: <span class="hljs-string">"El teléfono debe tener como mínimo 8 números"</span>,
            },
          },
        },
      },
    })
    .on(<span class="hljs-string">"success.form.fv"</span>, <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">e</span>) </span>{
      e.preventDefault();
      save_ventas();
    })
    .submit(<span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">e</span>) </span>{
      e.preventDefault();
    });
}

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">l_set_dom</span>(<span class="hljs-params"></span>) </span>{
  l_validate_form();

  <span class="hljs-keyword">if</span> (getQuerystring(<span class="hljs-string">"id"</span>) === <span class="hljs-string">""</span>) {
    l_list_patologias();
    l_hide_selectpicker_sub_pat();
    l_list_paises();
    l_list_os();
    l_sub_estado();
  } <span class="hljs-keyword">else</span> {
    l_set_paciente();
  }
}

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">save_ventas</span>(<span class="hljs-params"></span>) </span>{
  <span class="hljs-keyword">if</span> (getQuerystring(<span class="hljs-string">"id"</span>) === <span class="hljs-string">""</span>) {
    l_savePac();
  } <span class="hljs-keyword">else</span> {
    l_actualizaPac();
  }
}

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">l_savePac</span>(<span class="hljs-params"></span>) </span>{
  <span class="hljs-keyword">var</span> parametros = $(<span class="hljs-string">"#frm-paciente"</span>).serializeArray();
  parametros.push({ <span class="hljs-attr">name</span>: <span class="hljs-string">"oper"</span>, <span class="hljs-attr">value</span>: <span class="hljs-string">"savePac"</span> });
  $.ajax({
    <span class="hljs-attr">url</span>: aplicacion + <span class="hljs-string">"/ajax/ajx.paciente_form.php"</span>,
    <span class="hljs-attr">type</span>: <span class="hljs-string">"POST"</span>,
    <span class="hljs-attr">data</span>: parametros,
    <span class="hljs-attr">async</span>: <span class="hljs-literal">false</span>,
    <span class="hljs-attr">success</span>: <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">opciones</span>) </span>{
      <span class="hljs-keyword">if</span> (opciones.indexOf(<span class="hljs-string">"ERROR"</span>) != <span class="hljs-number">0</span>) {
        Swal.fire({
          <span class="hljs-attr">title</span>: <span class="hljs-string">"Registro Correcto"</span>,
          <span class="hljs-attr">text</span>: <span class="hljs-string">"Debe realizar la carga de documentación del paciente"</span>,
          <span class="hljs-attr">icon</span>: <span class="hljs-string">"info"</span>,
          <span class="hljs-attr">showCancelButton</span>: <span class="hljs-literal">true</span>,
          <span class="hljs-attr">allowOutsideClick</span>: <span class="hljs-literal">false</span>,
          <span class="hljs-attr">confirmButtonColor</span>: <span class="hljs-string">"#3085d6"</span>,
          <span class="hljs-attr">cancelButtonColor</span>: <span class="hljs-string">"#d33"</span>,
          <span class="hljs-attr">confirmButtonText</span>: <span class="hljs-string">"Si"</span>,
          <span class="hljs-attr">cancelButtonText</span>: <span class="hljs-string">"No"</span>,
        }).then(<span class="hljs-function">(<span class="hljs-params">result</span>) =&gt;</span> {
          <span class="hljs-keyword">if</span> (result.value) {
            localStorage.removeItem(<span class="hljs-string">"paramPaciente"</span>);
            <span class="hljs-keyword">const</span> paramPaciente = {
              <span class="hljs-attr">idPac</span>: opciones,
            };
            <span class="hljs-built_in">window</span>.localStorage.setItem(
              <span class="hljs-string">"paramPaciente"</span>,
              <span class="hljs-built_in">JSON</span>.stringify(paramPaciente)
            );
            <span class="hljs-built_in">window</span>.location.href =
              aplicacion +
              <span class="hljs-string">"/administrador/docs_paciente.php?id="</span> +
              opciones +
              <span class="hljs-string">"&amp;accion=alta"</span>;
          } <span class="hljs-keyword">else</span> {
            Swal.fire({
              <span class="hljs-attr">title</span>: <span class="hljs-string">"Paciente Creado Sin Documentación"</span>,
              <span class="hljs-attr">text</span>:
                <span class="hljs-string">"El paciente quedó en estado 'Sin Documentación' y no podrá ser utilizado en el sistema hasta que no se le cargue la documentación correspondiente"</span>,
              <span class="hljs-attr">icon</span>: <span class="hljs-string">"warning"</span>,
              <span class="hljs-attr">allowOutsideClick</span>: <span class="hljs-literal">false</span>,
              <span class="hljs-attr">showCancelButton</span>: <span class="hljs-literal">false</span>,
              <span class="hljs-attr">confirmButtonColor</span>: <span class="hljs-string">"#3085d6"</span>,
              <span class="hljs-attr">confirmButtonText</span>: <span class="hljs-string">"Ok"</span>,
            }).then(<span class="hljs-function">(<span class="hljs-params">result</span>) =&gt;</span> {
              <span class="hljs-keyword">if</span> (result.value) {
                parent.location.reload();
              }
            });
          }
        });
      } <span class="hljs-keyword">else</span> {
        alert(opciones);
      }
    },
  });
}

<span class="hljs-comment">/** Funcion que actualiza el paciente
 *
 * Esta funcion antes de realizar el post al backend
 * Solicita una nota que indique la modificación.
 * Esta nota luego será mostrada por el sistema
 * tanto en la dictaminacion del paciente como en el form de Atencion Paciente
 */</span>
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">l_actualizaPac</span>(<span class="hljs-params"></span>) </span>{
  <span class="hljs-keyword">const</span> swalWithBootstrapButtons = Swal.mixin({
    <span class="hljs-attr">customClass</span>: {
      <span class="hljs-attr">confirmButton</span>: <span class="hljs-string">"btn btn-success"</span>,
      <span class="hljs-attr">cancelButton</span>: <span class="hljs-string">"btn btn-danger"</span>,
    },
    <span class="hljs-attr">buttonsStyling</span>: <span class="hljs-literal">false</span>,
  });
  swalWithBootstrapButtons
    .fire({
      <span class="hljs-attr">title</span>: <span class="hljs-string">"Comentario de Modificación"</span>,
      <span class="hljs-attr">input</span>: <span class="hljs-string">"textarea"</span>,
      <span class="hljs-attr">icon</span>: <span class="hljs-string">"info"</span>,
      <span class="hljs-attr">text</span>: <span class="hljs-string">"Debe indicar un comentario para ejecutar esta acción"</span>,
      <span class="hljs-attr">allowOutsideClick</span>: <span class="hljs-literal">false</span>,
      <span class="hljs-attr">inputPlaceholder</span>: <span class="hljs-string">"Ingrese un Comentario"</span>,
      <span class="hljs-attr">inputAttributes</span>: {
        <span class="hljs-string">"aria-label"</span>: <span class="hljs-string">"Ingrese un Comentario"</span>,
      },
      <span class="hljs-attr">showCancelButton</span>: <span class="hljs-literal">true</span>,
      <span class="hljs-attr">confirmButtonText</span>: <span class="hljs-string">"Guardar"</span>,
      <span class="hljs-attr">cancelButtonText</span>: <span class="hljs-string">"Cancelar"</span>,
      <span class="hljs-attr">inputValidator</span>: <span class="hljs-function">(<span class="hljs-params">value</span>) =&gt;</span> {
        <span class="hljs-keyword">if</span> (!value) {
          <span class="hljs-keyword">return</span> <span class="hljs-string">"Debe escribir un comentario"</span>;
        }
      },
    })
    .then(<span class="hljs-function">(<span class="hljs-params">result</span>) =&gt;</span> {
      <span class="hljs-keyword">if</span> (result.value) {
        <span class="hljs-keyword">var</span> parametros = $(<span class="hljs-string">"#frm-paciente"</span>).serializeArray();
        parametros.push({
          <span class="hljs-attr">name</span>: <span class="hljs-string">"idPac"</span>,
          <span class="hljs-attr">value</span>: <span class="hljs-built_in">document</span>.getElementById(<span class="hljs-string">"idPac"</span>).innerHTML,
        });
        parametros.push({ <span class="hljs-attr">name</span>: <span class="hljs-string">"oper"</span>, <span class="hljs-attr">value</span>: <span class="hljs-string">"actualizaPac"</span> });
        parametros.push({ <span class="hljs-attr">name</span>: <span class="hljs-string">"notas"</span>, <span class="hljs-attr">value</span>: result.value });

        $.ajax({
          <span class="hljs-attr">url</span>: aplicacion + <span class="hljs-string">"/ajax/ajx.paciente_form.php"</span>,
          <span class="hljs-attr">type</span>: <span class="hljs-string">"POST"</span>,
          <span class="hljs-attr">data</span>: parametros,
          <span class="hljs-attr">async</span>: <span class="hljs-literal">false</span>,
          <span class="hljs-attr">success</span>: <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">opciones</span>) </span>{
            <span class="hljs-keyword">if</span> (opciones.indexOf(<span class="hljs-string">"ERROR"</span>) != <span class="hljs-number">0</span>) {
              sendEmailPacienteModificado();
              Swal.fire({
                <span class="hljs-attr">title</span>:
                  <span class="hljs-string">"Actualización Correcta. Desea actualizar la documentación?"</span>,
                <span class="hljs-attr">icon</span>: <span class="hljs-string">"info"</span>,
                <span class="hljs-attr">showCancelButton</span>: <span class="hljs-literal">true</span>,
                <span class="hljs-attr">allowOutsideClick</span>: <span class="hljs-literal">false</span>,
                <span class="hljs-attr">confirmButtonColor</span>: <span class="hljs-string">"#3085d6"</span>,
                <span class="hljs-attr">cancelButtonColor</span>: <span class="hljs-string">"#d33"</span>,
                <span class="hljs-attr">confirmButtonText</span>: <span class="hljs-string">"Si"</span>,
                <span class="hljs-attr">cancelButtonText</span>: <span class="hljs-string">"No"</span>,
              }).then(<span class="hljs-function">(<span class="hljs-params">result</span>) =&gt;</span> {
                <span class="hljs-keyword">if</span> (result.value) {
                  <span class="hljs-built_in">window</span>.location.href =
                    aplicacion +
                    <span class="hljs-string">"/administrador/docs_paciente.php?id="</span> +
                    getQuerystring(<span class="hljs-string">"id"</span>) +
                    <span class="hljs-string">"&amp;accion=mod"</span>;
                } <span class="hljs-keyword">else</span> {
                  Swal.fire({
                    <span class="hljs-attr">title</span>: <span class="hljs-string">"Registro Correcto"</span>,
                    <span class="hljs-attr">text</span>:
                      <span class="hljs-string">"El paciente será dictaminado por el área de FV. Hasta entonces, quedará en estado pendiente"</span>,
                    <span class="hljs-attr">icon</span>: <span class="hljs-string">"success"</span>,
                    <span class="hljs-attr">allowOutsideClick</span>: <span class="hljs-literal">false</span>,
                    <span class="hljs-attr">showCancelButton</span>: <span class="hljs-literal">false</span>,
                    <span class="hljs-attr">confirmButtonColor</span>: <span class="hljs-string">"#3085d6"</span>,
                    <span class="hljs-attr">confirmButtonText</span>: <span class="hljs-string">"Ok"</span>,
                  }).then(<span class="hljs-function">(<span class="hljs-params">result</span>) =&gt;</span> {
                    <span class="hljs-keyword">if</span> (result.value) {
                      parent.location.reload();
                    }
                  });
                }
              });
            } <span class="hljs-keyword">else</span> {
              alert(opciones);
            }
          },
        });
      }
    });
}

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">sendEmailPacienteModificado</span>(<span class="hljs-params"></span>) </span>{
  $.post(
    aplicacion + <span class="hljs-string">"/ajax/ajx.paciente.php"</span>,
    {
      <span class="hljs-attr">oper</span>: <span class="hljs-string">"sendEmailPaciente"</span>,
      <span class="hljs-attr">idPac</span>: <span class="hljs-built_in">document</span>.getElementById(<span class="hljs-string">"idPac"</span>).innerHTML,
      <span class="hljs-attr">accion</span>: <span class="hljs-string">"Modificacion Paciente"</span>,
    },
    <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">data, textStatus, jqXHR</span>) </span>{},
    <span class="hljs-string">"dataType"</span>
  );
}

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">save_admin</span>(<span class="hljs-params"></span>) </span>{
  <span class="hljs-keyword">if</span> (usuario.grupo == <span class="hljs-string">"fv"</span>) {
    <span class="hljs-keyword">var</span> parametros = {
      <span class="hljs-attr">oper</span>: <span class="hljs-string">"ValidaPac"</span>,
      <span class="hljs-attr">id</span>: $(<span class="hljs-string">"#id"</span>).val(),</pre></div></div>
            
        </li>
        
        
        <li id="section-17">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-17">&#182;</a>
              </div>
              <p>“nombre”: $(‘#nombre’).val(),</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>      comentario: $(<span class="hljs-string">"#comentario"</span>).val(),
      <span class="hljs-attr">estado</span>: $(<span class="hljs-string">"#estadoVal"</span>).val(),
    };
    $.ajax({
      <span class="hljs-attr">url</span>: aplicacion + <span class="hljs-string">"/ajax/ajx.paciente_form.php"</span>,
      <span class="hljs-attr">type</span>: <span class="hljs-string">"POST"</span>,
      <span class="hljs-attr">data</span>: parametros,
      <span class="hljs-attr">async</span>: <span class="hljs-literal">false</span>,
      <span class="hljs-attr">success</span>: <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">opciones</span>) </span>{
        <span class="hljs-keyword">if</span> (opciones.indexOf(<span class="hljs-string">"ERROR"</span>) != <span class="hljs-number">0</span>) {
          alert(<span class="hljs-string">"Se registró correctamente."</span>);
          l_mail_dictamenPaciente($(<span class="hljs-string">"#id"</span>).val());
          <span class="hljs-built_in">window</span>.location.href = aplicacion + <span class="hljs-string">"/main/panel.php"</span>;
        } <span class="hljs-keyword">else</span> {
          alert(opciones);
        }
      },
    });
  } <span class="hljs-keyword">else</span> {
    save_ventas();
  }
}

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">l_mail_dictamenPaciente</span>(<span class="hljs-params">idPac</span>) </span>{
  $.post(
    aplicacion + <span class="hljs-string">"/ajax/ajx.paciente.php"</span>,
    {
      <span class="hljs-attr">oper</span>: <span class="hljs-string">"sendEmailPaciente"</span>,
      <span class="hljs-attr">idPac</span>: idPac,
      <span class="hljs-attr">accion</span>: <span class="hljs-string">"Dictamen Paciente"</span>,
    },
    <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">data, textStatus, jqXHR</span>) </span>{},
    <span class="hljs-string">"dataType"</span>
  );
}

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">getCurrentHostname</span>(<span class="hljs-params"></span>) </span>{
  <span class="hljs-keyword">var</span> protocolo, url, var_port, port;

  protocolo = <span class="hljs-built_in">window</span>.location.protocol;
  url = <span class="hljs-built_in">window</span>.location.hostname;
  var_port = <span class="hljs-built_in">window</span>.location.port;

  <span class="hljs-keyword">if</span> (var_port !== <span class="hljs-string">""</span>) {
    port = <span class="hljs-string">":"</span> + var_port;
  } <span class="hljs-keyword">else</span> {
    port = <span class="hljs-string">""</span>;
  }

  <span class="hljs-keyword">return</span> protocolo + <span class="hljs-string">"//"</span> + url + port;
}

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">getUrlHTTP</span>(<span class="hljs-params"></span>) </span>{
  <span class="hljs-keyword">var</span> path = <span class="hljs-built_in">window</span>.location.pathname;
  <span class="hljs-keyword">var</span> appName = path.split(<span class="hljs-string">"/"</span>);
  <span class="hljs-keyword">return</span> appName[<span class="hljs-number">1</span>];
}

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">getQuerystring</span>(<span class="hljs-params">key, default_</span>) </span>{
  <span class="hljs-keyword">if</span> (default_ == <span class="hljs-literal">null</span>) default_ = <span class="hljs-string">""</span>;
  key = key.replace(<span class="hljs-regexp">/[\[]/</span>, <span class="hljs-string">"\\["</span>).replace(<span class="hljs-regexp">/[\]]/</span>, <span class="hljs-string">"\\]"</span>);
  <span class="hljs-keyword">var</span> regex = <span class="hljs-keyword">new</span> <span class="hljs-built_in">RegExp</span>(<span class="hljs-string">"[\\?&amp;]"</span> + key + <span class="hljs-string">"=([^&amp;#]*)"</span>);
  <span class="hljs-keyword">var</span> qs = regex.exec(<span class="hljs-built_in">window</span>.location.href);
  <span class="hljs-keyword">if</span> (qs == <span class="hljs-literal">null</span>) <span class="hljs-keyword">return</span> default_;
  <span class="hljs-keyword">else</span> <span class="hljs-keyword">return</span> qs[<span class="hljs-number">1</span>];
}</pre></div></div>
            
        </li>
        
    </ul>
  </div>
</body>
</html>
